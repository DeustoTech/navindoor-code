function [Acc,Gyr,Mag,Stance,StepDectSample,Pos_G,Vel_G,Att_G]=simula_trayecto(longitud,speed,direccion,curvatura,Pos_G_ini,Att_foot,gravedad,fs,ver,idx_fig,mom_dipolo,pos_dipolo,amp_osc_dipolo,dir_osc_dipolo,fre_osc_dipolo)

%=========================================================================
% Funcion que SIMULA los datos de una IMU colocada en el PIE cuando se camina en línea recta/curva o cuando se está quieto.
%    Asume: - El pie está en reposo al comenzar y termina en reposo
%           - La longitud del paso depende de la velocidad deseada 
%    Ejemplos uso: [Acc,Gyr,Mag,Stance,StepDectSample,Pos_G,Vel_G,Att_G]=simula_trayecto(2,0.89,0,0,[0 0 0],[0 0 45],9.8,100,1,1);
%                  [Acc,Gyr,Mag,Stance,StepDectSample,Pos_G,Vel_G,Att_G]=simula_trayecto(2,0.89,0,0,[0 0 0],[0 0 45],9.8,100,1,1,[1 0 0],[1 1 0],0,0,0);
%                  [Acc,Gyr,Mag,Stance,StepDectSample,Pos_G,Vel_G,Att_G]=simula_trayecto(3,0.8,0,0,[0 0 0],[0 0 0],9.8,100,1,1,[0.1 0 0; 0.1 0 0],[1.5 0.5 0; 1.5 -0.5 0],[0;0],[0;0],[0;0]);
% INPUT:
%      longitud:  Distancia recorrida de la recta (m) (longitud>0) / si "longitud=0" quiero simular still (parado sin moverme)
%      speed:     Velocidad de avance de la persona (m/s). Debe ser mayor que "0" / si "longitud=0" => "speed" son los segundos parado
%      direccion: Direcion de avance del camino recto (º).
%      curvatura: 0 indica trayecto recto, si >0 inverso de radio de circunferencia (CCW), o CW si es <0
%      Pos_G_ini: Posicion inicial de la IMU en en sistema navegacion global G; [1x3] X,Y,Z [m]
%      Att_foot: Orientación de IMU respecto al pie en el suelo; [1x3] [º] Attitude en roll,pitch y yaw
%                  (Junto con la direccion de la trayectoria, define la orientacion en sistema Global G: Att_G_ini)  
%      gravedad: gravedad terresttre m/s^2
%      fs:       Frecuencia muestreo (Hz)
%      ver:      0: no ver figuras;  distinto de cero: verlas
%      idx_fig:  entero que indica en que figura hay que hacer la primera representación
%      ----Extra inputs (perturbaciones magneticas: 1 o varios (k) dipolos moviendose o fijos)
%      mom_dipolo:      [kx3] momento(s) dipolar(es) perturbacion(es); donde k es numero dipolos magneticos perturbadores
%      pos_dipolo:      [kx3] posicion de los dipolos magneticos
%      amp_osc_dipolo:  [kx1] amplitud de oscilacion en metros (poner amplitud cero para que no se muevan dipolos)
%      dir_osc_dipolo:  [kx1] direccion oscilacion en grados respecto eje X
%      fre_osc_dipolo:  [kx1] frecuencia de oscilacion en Hz (ciclos/segundo)
% OUTPUT:
%     Acc:       Matriz [nx3] de "n" muestras de las aceleraciones medidas con los acelerometros en X,Y y Z (m/s^2)
%     Gyr:       Matriz [nx3] de "n" muestras de las velocidades angulares medidas con giroscopos en X,Y y Z  (rad/s)
%     Mag:       Matriz [nx3] de "n" muestras de las medidas de los magnetometros en X,Y y Z (unidades arbitrarias)
%     Stance:    Vector(nx1) con valores 0 o 1 indicando cuando estamos en apoyo (1=apoyo)
%     StepDectSample:
%     Pos_G:     Posicion verdadera de IMU en sistema navegacion global G;   Po [nx3] X,Y,Z [m]
%     Vel_G:     Velocidad verdadera de IMU en sistema navegacion global G;  Ve [nx3] Vx,Vy,Vz [m/s]
%     Att_G:     Orientación verdadera de IMU en frame global G;            Att [nx3] Attitude en roll,pitch y yaw [º]%

% Gestionar el número de parametros de entrada
if nargin < 10
    disp('Error faltan parametros');
    Acc=[];Gyr=[];Mag=[];Stance=[];StepDectSample=[];Pos_G=[];Vel_G=[];Att_G=[];
    return
end
if nargin == 10  % me faltan los parametros de perturbacion => los inicializo yo a cero
    %disp('Parametros de dipolos faltantes. Asumimos que no se desean perturbaciones magneticas');
    mom_dipolo=[];
    pos_dipolo=[];
    amp_osc_dipol=[];
    dir_osc_dipolo=[];
    fre_osc_dipolo=[];
end


% cargar datos experimentales (Francisco caminando en linea recta con IMU en pie en UAH-pasillo)
Acc_recortado=[-7.490808963775635,-2.559373140335083,8.75108528137207;-7.673609733581543,0.976580023765564,7.932824611663818;-6.514901161193848,0.335572928190231,7.958618640899658;-6.697163105010986,-0.139483690261841,8.04167366027832;-6.250222206115723,0.660813093185425,7.924838542938232;-6.349414825439453,0.734891533851624,7.953261852264404;-6.15220308303833,1.322183609008789,7.926558971405029;-6.015010356903076,1.299787044525146,7.938264846801758;-5.971411228179932,1.726594686508179,7.848484992980957;-5.975265026092529,1.69731879234314,7.78499174118042;-6.006577014923096,1.526401877403259,7.738003730773926;-6.042898178100586,1.326186895370483,7.747031211853027;-6.045249938964844,1.136197090148926,7.769310474395752;-6.11121416091919,0.959912717342377,7.772470951080322;-6.024916172027588,0.927050471305847,7.750872611999512;-5.863848686218262,1.150964736938477,7.706706523895264;-5.941543102264404,1.110891103744507,7.706772327423096;-6.066710472106934,1.004388928413391,7.656680583953857;-6.038358688354492,1.097337365150452,7.620788097381592;-5.965225219726562,0.962003886699676,7.59654712677002;-5.965483665466309,1.132471561431885,7.620580196380615;-6.024757385253906,0.910017013549805,7.506943225860596;-5.952763080596924,1.015763759613037,7.491922378540039;-6.083349227905273,1.24769139289856,7.494626522064209;-6.221726417541504,1.408888459205627,7.397203922271728;-6.064053535461426,0.551461815834045,7.55524206161499;-6.144976615905762,0.791408240795136,7.469232082366943;-6.26476240158081,0.626533389091492,7.456027507781982;-6.314128398895264,0.674536764621735,7.42996883392334;-6.354562282562256,0.59602963924408,7.428853511810303;-6.320146083831787,0.752381205558777,7.42961597442627;-6.372286796569824,0.80034339427948,7.437625408172607;-6.320804119110107,0.801078498363495,7.424614429473877;-6.232532501220703,0.763371050357819,7.459201335906982;-6.082671642303467,0.804468333721161,7.583401679992676;-6.049784660339356,0.873124778270721,7.620894432067871;-6.071764945983887,0.707209646701813,7.613225936889648;-6.222636222839356,0.578427195549011,7.47209882736206;-6.209520816802978,0.481198847293854,7.526390075683594;-6.301599979400635,0.62113606929779,7.479270458221436;-6.303881645202637,0.73312509059906,7.547276496887207;-6.370312213897705,0.83446615934372,7.435176849365234;-6.457972049713135,0.852701425552368,7.366494178771973;-6.492516994476318,0.869255542755127,7.37268590927124;-6.500475406646728,0.735198676586151,7.384912014007568;-6.266146183013916,0.619236350059509,6.850954055786133;-6.470007419586182,0.199914008378983,6.301326751708984;-7.436512470245361,1.56451690196991,6.309379577636719;-8.3065185546875,4.99071455001831,7.665337085723877;-11.107254981994629,5.647186279296875,9.207525253295898;-14.357340812683105,4.921291351318359,10.723745346069336;-18.071456909179688,3.365678548812866,11.385319709777832;-19.136062622070312,3.248123407363892,13.137746810913086;-21.599140167236328,1.19172477722168,11.90770149230957;-21.64790916442871,2.038581848144531,10.621109962463379;-19.360801696777344,3.985332727432251,11.494501113891602;-15.714216232299805,5.741880893707275,15.746362686157227;-11.585073471069336,5.235760688781738,16.490406036376953;-23.64674949645996,6.30549430847168,20.7078800201416;-29.719776153564453,11.405540466308594,32.225433349609375;-20.10106658935547,15.103534698486328,25.339529037475586;-11.857625961303711,15.389548301696777,17.55846405029297;-4.928178787231445,12.412923812866211,10.669723510742188;-0.746347069740295,8.615216255187988,6.852746486663818;1.012508392333984,5.990757465362549,5.210953712463379;1.0623459815979,4.564381122589111,4.978855609893799;-0.070501208305359,3.827333688735962,5.610593795776367;-1.336982488632202,3.582741737365723,6.422494411468506;-2.606647968292236,3.564589738845825,7.224062919616699;-3.959920167922974,3.572033166885376,8.032691955566406;-5.965207099914551,3.470311880111694,9.145401954650879;-8.102792739868164,3.186499357223511,10.0469331741333;-9.060909271240234,2.846500635147095,9.973418235778809;-8.627045631408691,2.273131608963013,8.968545913696289;-8.045304298400879,1.640990495681763,7.936757564544678;-8.187110900878906,0.871858656406403,7.565482139587402;-9.111788749694824,0.391062259674072,8.039811134338379;-10.574662208557129,-0.095001704990864,9.033859252929688;-12.556992530822754,-0.07706356048584,10.122649192810059;-13.792598724365234,-0.494127660989761,11.035914421081543;-13.939518928527832,-0.505954623222351,10.816597938537598;-14.374886512756348,-0.624186933040619,10.737199783325195;-15.42243766784668,-0.512514412403107,11.140534400939941;-17.809040069580078,0.213216453790665,11.995485305786133;-20.80748176574707,1.334484338760376,12.796100616455078;-24.8376522064209,1.963701367378235,13.774918556213379;-29.455577850341797,1.927029371261597,14.05341625213623;-32.874000549316406,0.694791734218597,11.981449127197266;-33.55503845214844,-2.039804935455322,6.827605247497559;-32.29271697998047,-5.089989185333252,0.254999905824661;-31.21978187561035,-7.224795341491699,-5.559441089630127;-29.07344627380371,-7.013591766357422,-13.330735206604004;-25.331525802612305,-5.035768985748291,-24.587923049926758;-29.902584075927734,-15.565309524536133,-29.863201141357422;-32.29875183105469,-21.43688201904297,-31.532073974609375;-28.69843864440918,-12.932537078857422,-31.0992431640625;-23.97478675842285,-2.634645462036133,-25.067228317260742;-12.181342124938965,-10.698576927185059,-8.248392105102539;-7.975935935974121,3.46062707901001,19.287073135375977;-0.273321866989136,10.097075462341309,21.48817253112793;3.357001543045044,1.837873697280884,5.503599643707275;-3.723353147506714,3.648793935775757,1.157625555992126;-16.269744873046875,3.313515663146973,10.054237365722656;-17.700942993164062,-3.214319944381714,15.065438270568848;-28.715030670166016,6.754305362701416,21.55176544189453;-15.898307800292969,5.028507232666016,8.025260925292969;-11.5449857711792,-1.57258665561676,11.423988342285156;-10.780294418334961,-3.870350122451782,11.172407150268555;-10.104424476623535,1.74061107635498,9.508448600769043;-9.462310791015625,-0.51025265455246,10.480060577392578;-9.664154052734375,-3.53783130645752,11.104555130004883;-7.830899715423584,-0.574558556079864,8.565406799316406;-7.081715106964111,1.221243739128113,8.077902793884277;-6.663321018218994,0.399205565452576,8.034300804138184;-6.552677631378174,0.588308095932007,7.944697856903076;-6.348941326141357,1.100200891494751,7.862246036529541;-6.257389068603516,1.191613554954529,7.86983060836792;-6.137919902801514,1.393014788627624,7.860991477966309;-6.051786422729492,1.360149383544922,7.856465816497803;-6.066714286804199,1.379419088363648,7.853513717651367;-6.016993045806885,1.37039041519165,7.784354209899902;-6.15087080001831,1.334386587142944,7.770435333251953;-6.166362762451172,1.076023101806641,7.736328601837158;-6.150753021240234,1.032411456108093,7.705196857452393;-6.106227874755859,1.179166913032532,7.686781883239746;-6.173552513122559,1.314587712287903,7.616057872772217;-5.855298042297363,1.66494607925415,7.569281578063965;-6.038731098175049,1.521082401275635,7.529623031616211;-6.157466888427734,1.680124402046204,7.427947521209717;-6.050809383392334,1.783932209014893,7.372551918029785;-6.090022563934326,1.442427039146423,7.386662483215332;-6.11557674407959,1.485895991325378,7.43455696105957;-6.020527839660644,2.110701084136963,7.292318344116211;-6.18217658996582,1.022235035896301,7.42853832244873;-6.584372997283936,0.690171182155609,7.275005340576172;-6.860279560089111,1.44606351852417,7.101240158081055;-6.504471778869629,0.062997475266457,7.288600444793701;-6.514455795288086,0.700917720794678,7.111295223236084;-6.526000022888184,0.764067232608795,7.198627471923828;-6.485449314117432,0.818221628665924,7.224194049835205;-6.567516803741455,0.7245072722435,7.251070022583008;-6.587121963500977,0.743711352348328,7.226012706756592;-6.456299781799316,0.82350754737854,7.237303733825684;-6.549414157867432,0.851404130458832,7.212342739105225;-6.431193351745606,0.775159001350403,7.243078231811523;-6.333165645599365,0.898321270942688,7.292276859283447;-6.197572231292725,1.109689593315124,7.371755599975586;-6.221714973449707,1.094733834266663,7.361264228820801;-6.313677787780762,0.898598909378052,7.300211429595947;-6.343533039093018,0.776407778263092,7.282444477081299;-6.36826229095459,0.824763536453247,7.237646579742432;-6.403500080108643,0.902191698551178,7.22417163848877;-6.453995227813721,1.003754377365112,7.234560966491699;-6.561262607574463,0.972999691963196,7.243430137634277;-6.726772308349609,0.895141959190369,7.274952411651611;-6.581241607666016,1.075003385543823,7.132798671722412;-6.554990768432617,1.036442875862122,6.499388217926025;-7.129492282867432,1.305894017219544,6.061023712158203;-7.379977226257324,2.73426628112793,6.550257682800293;-8.513463973999023,5.14848518371582,7.834119319915772;-11.057108879089355,6.11548662185669,9.137383460998535;-14.924224853515625,3.651740074157715,10.035103797912598;-18.096811294555664,3.964420080184936,11.085625648498535;-20.19562339782715,4.187633991241455,13.541413307189941;-22.239233016967773,2.405130386352539,11.777573585510254;-22.401071548461914,2.04729700088501,11.09008502960205;-20.99462890625,4.785075664520264,13.314834594726562;-17.408504486083984,6.116976737976074,18.385408401489258;-12.88563060760498,3.526926755905151,19.987953186035156;-28.81056022644043,7.327418327331543,27.03199005126953;-26.57941246032715,12.972420692443848,32.194644927978516;-15.418895721435547,17.21613311767578,22.638551712036133;-7.105838298797607,15.084877967834473,14.571968078613281;-1.318739652633667,11.568299293518066,9.002248764038086;1.63692843914032,7.950321197509766,5.997562885284424;2.27815842628479,5.789637565612793,5.153823375701904;0.783942520618439,4.935405254364014,5.893919944763184;-1.497181057929993,4.676314830780029,7.183650016784668;-3.370052814483643,5.017285346984863,8.104449272155762;-4.816478729248047,5.247464179992676,8.599825859069824;-6.050900936126709,5.412493705749512,8.770244598388672;-7.496768474578857,5.299314498901367,8.963831901550293;-8.90452766418457,4.831128120422363,9.03738021850586;-9.552233695983887,4.144893646240234,8.49622631072998;-9.451751708984375,3.408469200134277,7.556778430938721;-9.524457931518555,2.513704538345337,6.80491828918457;-9.896109580993652,1.853302478790283,6.767702579498291;-10.605667114257812,1.66052770614624,6.823728561401367;-12.259598731994629,0.95013040304184,7.675577640533447;-12.949535369873047,0.404477030038834,8.508784294128418;-14.286014556884766,0.02980973944068,9.418769836425781;-15.230525970458984,0.099078938364983,10.61347484588623;-16.76791763305664,0.213453441858292,12.089412689208984;-19.33296012878418,0.115889154374599,13.913877487182617;-22.072500228881836,0.40066334605217,14.743945121765137;-24.428600311279297,0.552166223526001,14.06404972076416;-27.025236129760742,-0.083888113498688,12.373031616210938;-29.95073127746582,-1.026581287384033,9.9891357421875;-31.555696487426758,-1.911395192146301,6.036691188812256;-30.91074562072754,-2.790816783905029,0.35491344332695;-28.950931549072266,-3.631975889205933,-5.773288726806641;-26.726184844970703,-4.58384370803833,-11.307351112365723;-26.854084014892578,-7.556543827056885,-15.884509086608887;-30.858116149902344,-12.196732521057129,-20.331958770751953;-30.22168731689453,-13.163970947265625,-25.506364822387695;-26.440773010253906,-9.583577156066895,-27.765615463256836;-24.334583282470703,-7.188984394073486,-24.537254333496094;-19.730037689208984,-10.230603218078613,-27.922807693481445;-10.601014137268066,-11.689434051513672,-1.716491937637329;-9.157751083374023,5.469723224639893,24.1541690826416;1.212880730628967,1.969841361045837,18.351261138916016;2.34300708770752,-0.716545343399048,3.651957273483276;-11.758907318115234,-1.541271328926086,5.671665191650391;-20.262998580932617,-3.528465986251831,14.375120162963867;-21.579097747802734,-1.930339574813843,17.55543327331543;-26.560029983520508,15.869088172912598,15.46751880645752;-13.229514122009277,6.598403453826904,7.935632228851318;-10.999470710754395,-4.759992599487305,12.406697273254395;-9.410633087158203,-1.612673044204712,9.571548461914062;-10.032296180725098,3.032362461090088,9.471439361572266;-8.724183082580566,-1.746601581573486,10.371807098388672;-9.667630195617676,-2.787801504135132,11.098000526428223;-7.272511959075928,-0.435083568096161,8.538865089416504;-6.353839874267578,1.187784790992737,8.237621307373047;-6.844808101654053,-0.002783355535939,8.180659294128418;-6.420563220977783,0.560967266559601,7.983089923858643;-6.32335376739502,0.995845198631287,7.902307987213135;-6.37091064453125,0.907495558261871,7.893669128417969;-6.214052677154541,1.219018936157227,7.900420665740967;-6.118337631225586,1.393294215202332,7.859170436859131;-6.03995943069458,1.754842281341553,7.8121018409729;-6.139586448669434,1.568338513374329,7.770304203033447;-6.209604740142822,1.360338926315308,7.734367370605469;-6.296090126037598,1.276305913925171,7.697650909423828;-6.21125078201294,1.146007776260376,7.720124244689941;-6.070659637451172,1.262475728988648,7.677974224090576;-6.178183555603027,1.295039057731628,7.618391990661621;-5.962377548217773,1.629324078559876,7.56596851348877;-6.147278308868408,1.609642386436462,7.491848945617676;-6.077962875366211,1.603328943252564,7.415984630584717;-6.124295711517334,1.782883167266846,7.384867668151856;-5.972257137298584,1.617017149925232,7.341229438781738;-5.984707832336426,1.551080107688904,7.462958335876465;-6.265451431274414,1.086804747581482,7.342819690704346;-6.013791084289551,0.829807996749878,7.505017757415772;-6.280082702636719,1.298472285270691,7.273603439331055;-6.712674140930176,1.360495805740356,7.142683506011963;-6.373744487762451,0.279167532920837,7.358156681060791;-6.342263221740723,0.703367233276367,7.260679721832275;-6.387518405914307,0.722199499607086,7.359236240386963;-6.208812236785889,0.827028751373291,7.440301418304443;-6.293770790100098,0.772238910198212,7.454805850982666;-6.296862125396728,0.813595056533814,7.459501266479492;-6.307015895843506,0.871900200843811,7.410264492034912;-6.294427394866943,0.855033099651337,7.398499488830566;-6.232239723205566,0.712231278419495,7.505671501159668;-6.098480224609375,0.728748857975006,7.561102390289307;-6.024983406066894,0.853996336460114,7.614399909973144;-5.949756622314453,1.064507246017456,7.613900661468506;-5.984218120574951,1.117595434188843,7.556586742401123;-6.023687839508057,0.995267868041992,7.521437644958496;-6.0740647315979,0.950715065002441,7.485781192779541;-6.132409572601318,0.979110300540924,7.405805587768555;-6.191788673400879,1.075679659843445,7.330534934997559;-6.333468914031982,0.971380293369293,7.214044094085693;-6.531240940093994,0.983173310756683,7.158969402313232;-6.652566909790039,0.898640215396881,7.18458366394043;-6.570457458496094,1.296780228614807,6.949699878692627;-6.556246757507324,1.467477321624756,6.488690376281738;-7.163254737854004,2.221076726913452,6.40936279296875;-7.4340500831604,4.024198055267334,6.919129371643066;-9.170968055725098,4.929654121398926,8.111419677734375;-11.972039222717285,5.264694213867188,8.905280113220215;-16.061050415039062,3.462590932846069,10.509432792663574;-18.486352920532227,4.772230625152588,11.708378791809082;-21.244951248168945,3.55168342590332,12.972811698913574;-22.098543167114258,2.767597198486328,11.103032112121582;-20.986474990844727,3.163408517837524,10.349363327026367;-18.737653732299805,5.279970169067383,13.663326263427734;-14.878653526306152,5.97779130935669,17.014110565185547;-13.993036270141602,3.223873376846314,17.58948516845703;-30.383647918701172,8.430039405822754,28.187576293945312;-24.940555572509766,14.086941719055176,29.76542854309082;-15.374269485473633,15.960212707519531,21.171445846557617;-8.0350923538208,14.31184196472168,13.680530548095703;-2.556825160980225,10.97592830657959,8.410507202148438;0.378845781087875,7.603623390197754,5.587653160095215;1.534357309341431,5.598845958709717,4.44757604598999;1.008050203323364,4.631809711456299,4.674474716186523;-0.599761843681335,4.175336360931396,5.688272953033447;-2.233053922653198,4.463707447052002,6.702151298522949;-3.663276672363281,5.071578979492188,7.485135555267334;-5.17828893661499,5.575965881347656,8.085116386413574;-6.647738456726074,5.764419555664062,8.494461059570312;-7.795099258422852,5.528866291046143,8.609917640686035;-8.424156188964844,4.952478885650635,8.25210189819336;-8.945379257202148,4.104879379272461,7.773839473724365;-9.78740119934082,3.513286828994751,7.201944351196289;-10.264518737792969,2.809987306594849,7.005340576171875;-10.695419311523438,2.263205528259277,6.853787422180176;-11.794910430908203,1.675207138061523,7.100797653198242;-12.606315612792969,1.592980265617371,7.658388614654541;-14.253775596618652,0.541701793670654,9.111319541931152;-15.563741683959961,0.401194393634796,10.21683120727539;-16.713516235351562,0.857203185558319,11.062677383422852;-18.24454116821289,1.317515969276428,11.867177963256836;-20.315404891967773,1.63375461101532,12.557313919067383;-22.960908889770508,1.802983999252319,13.195422172546387;-26.454517364501953,1.28800368309021,13.01766586303711;-29.99552345275879,-0.058029096573591,11.398283004760742;-32.18998718261719,-1.370146989822388,7.833071708679199;-32.486602783203125,-2.601535558700562,2.661415815353394;-31.556407928466797,-3.910374164581299,-3.03727912902832;-29.69639778137207,-4.928322315216064,-8.697407722473145;-27.57851791381836,-6.183688640594482,-14.361082077026367;-29.561582565307617,-10.634262084960938,-19.903850555419922;-31.387544631958008,-15.506342887878418,-25.37734031677246;-28.60038185119629,-14.00029468536377,-30.025325775146484;-24.284513473510742,-8.162126541137695,-30.281570434570312;-17.836790084838867,-1.075883507728577,-30.521770477294922;-7.550582885742188,-10.379321098327637,-6.482605934143066;-7.63606595993042,6.171058654785156,20.548614501953125;-1.051143646240234,8.668700218200684,19.83194923400879;2.20535945892334,-1.371321201324463,6.727868556976318;-7.630663394927978,-3.011661291122436,3.65351414680481;-18.938457489013672,-4.035496711730957,12.227230072021484;-23.179378509521484,-3.519125938415527,18.4766845703125;-28.2877140045166,10.486573219299316,18.812835693359375;-12.819151878356934,4.92636775970459,6.96158504486084;-10.82319164276123,-3.018641471862793,12.05488395690918;-9.87844467163086,-2.513129234313965,9.973377227783203;-9.311776161193848,4.121501445770264,9.213834762573242;-8.90402603149414,0.152815774083138,10.437785148620605;-9.821442604064941,-3.708128452301025,11.436613082885742;-7.368023872375488,-0.548467636108398,8.467768669128418;-7.052461624145508,0.863666892051697,8.118609428405762;-6.590436935424805,0.056862216442823,8.09343433380127;-6.546828746795654,0.101321250200272,8.070323944091797;-6.337459087371826,0.956678867340088,7.901943683624268;-6.347121238708496,0.941928625106812,7.91142749786377;-6.172572612762451,1.22204577922821,7.906606197357178;-6.194247722625732,1.187641263008118,7.923069953918457;-6.037938594818115,1.60875129699707,7.822229385375977;-5.93022346496582,1.639514565467834,7.767019748687744;-6.072281837463379,1.671583771705627,7.738061904907227;-6.035457611083984,1.47971773147583,7.75914478302002;-6.212390899658203,1.216615319252014,7.732139110565186;-6.147462368011475,1.115257382392883,7.746603012084961;-6.117652893066406,1.125427007675171,7.684092998504639;-5.950744152069092,1.429788589477539,7.674099922180176;-6.158588886260986,1.31236720085144,7.589699268341064;-6.264854431152344,1.293809175491333,7.476589679718018;-6.210997104644775,1.294577836990356,7.470973014831543;-6.187511444091797,1.387457013130188,7.43248701095581;-6.09370231628418,1.342525243759155,7.41115140914917;-6.169831275939941,1.714044332504272,7.390890121459961;-6.019874095916748,1.34601628780365,7.359806060791016;-5.788736343383789,2.050694465637207,7.189989566802978;-6.337820053100586,1.039502739906311,7.308912754058838;-6.691255569458008,1.920926332473755,7.122674465179443;-6.452917575836182,0.536183953285217,7.318520069122314;-6.511059284210205,0.937189877033234,7.164583206176758;-6.595292091369629,0.609650492668152,7.260189533233643;-6.344508647918701,0.827534437179565,7.306703567504883;-6.330604076385498,0.874003469944,7.316805362701416;-6.40014123916626,0.931458055973053,7.338882923126221;-6.355805397033691,0.902866184711456,7.350103855133057;-6.344508647918701,0.988265097141266,7.318566799163818;-6.331779956817627,0.932432770729065,7.350801944732666;-6.141907215118408,0.949750304222107,7.420204639434814;-6.066635131835938,1.121294140815735,7.473461627960205;-6.092517852783203,1.198853731155396,7.504197120666504;-6.155107021331787,1.166304230690002,7.448611736297607;-6.107584476470947,1.271701693534851,7.435256958007812;-6.027633666992188,1.482279181480408,7.451984882354736;-6.073615074157715,1.306281924247742,7.411862373352051;-6.159862041473389,1.290447354316711,7.248147010803223;-6.261061668395996,1.254914045333862,7.142552375793457;-6.565326690673828,0.992429733276367,7.128595352172852;-6.688907623291016,0.781231701374054,7.071453094482422;-6.710082530975342,1.024471163749695,6.872660160064697;-6.922093868255615,1.323439598083496,6.594522953033447;-7.009866237640381,2.237874746322632,6.458094596862793;-6.888741970062256,2.743708610534668,6.580416202545166;-7.617719650268555,3.393266677856445,6.875600337982178;-9.13167953491211,4.155799865722656,7.738563060760498;-11.770227432250977,4.152194976806641,8.928624153137207;-14.312056541442871,4.359464645385742,8.90633487701416;-18.2580623626709,5.116436958312988,11.61485481262207;-20.73939323425293,4.301718711853027,11.928410530090332;-21.623340606689453,4.289114475250244,11.788247108459473;-20.331064224243164,3.659834146499634,10.125091552734375;-19.146526336669922,5.245052814483643,10.717947006225586;-16.40249252319336,6.01945686340332,15.172637939453125;-13.443427085876465,2.944287061691284,18.846820831298828;-24.424198150634766,4.346175670623779,20.06281089782715;-28.503305435180664,10.955406188964844,30.291139602661133;-18.45850944519043,13.94837760925293,23.149377822875977;-11.413434982299805,12.685426712036133,16.4046630859375;-5.495790004730225,11.696155548095703,10.492242813110352;-1.824283719062805,9.203795433044434,6.900368213653564;-0.085949756205082,6.817705154418945,5.252549171447754;0.492630511522293,5.49874210357666,4.566091537475586;0.07974037528038,4.842612266540527,4.739816188812256;-0.773595094680786,4.552780628204346,5.391662120819092;-1.94132924079895,4.599401473999023,6.179242134094238;-3.306079149246216,5.159506320953369,6.839972972869873;-4.835852146148682,6.028982639312744,7.407009124755859;-6.564092636108398,6.596083164215088,7.956198692321777;-7.946547985076904,6.773607730865478,8.239014625549316;-8.967642784118652,6.398616790771484,8.15382194519043;-9.44997501373291,5.480941295623779,7.806239128112793;-9.586599349975586,4.329536437988281,7.472520351409912;-10.049799919128418,3.529023885726929,7.247283935546875;-11.122323036193848,2.739264249801636,7.790771484375;-12.732989311218262,3.235002517700195,7.924201488494873;-14.52942943572998,1.33163595199585,10.125624656677246;-14.567093849182129,0.814804792404175,10.242616653442383;-14.785151481628418,0.928595662117004,10.108616828918457;-15.554736137390137,1.122177600860596,10.22780990600586;-17.34041404724121,1.247676491737366,10.549212455749512;-19.957651138305664,1.731506824493408,10.321465492248535;-23.1185302734375,2.363449335098267,9.934708595275879;-27.676584243774414,2.332496166229248,10.33707332611084;-32.83470916748047,1.411436557769775,9.87817668914795;-35.72329330444336,-0.039675261825323,6.715805053710938;-36.05588912963867,-1.83412492275238,1.302655339241028;-34.48329162597656,-4.607144832611084,-4.887438774108887;-31.370834350585938,-7.207223415374756,-10.709580421447754;-27.701187133789062,-8.83497142791748,-16.418537139892578;-27.591737747192383,-10.747339248657227,-21.329517364501953;-31.144474029541016,-15.13029956817627,-24.7702693939209;-29.00301170349121,-16.00309181213379,-28.133359909057617;-23.894695281982422,-12.058043479919434,-28.32398796081543;-17.317806243896484,-4.463568687438965,-25.228534698486328;-5.86483097076416,-6.653807163238525,-1.738191366195679;-2.707500219345093,6.682116985321045,21.584192276000977;3.621423006057739,8.038938522338867,18.190338134765625;4.636346340179443,1.191381216049194,3.43264102935791;-8.552663803100586,0.20933011174202,2.851561307907104;-20.003890991210938,-0.207745775580406,11.941568374633789;-33.17473220825195,11.344364166259766,26.102407455444336;-17.57916831970215,4.264216423034668,7.441827774047852;-13.466367721557617,-1.614655375480652,12.370888710021973;-12.363248825073242,-5.614748001098633,12.053056716918945;-9.944677352905273,-0.475721895694733,10.225638389587402;-7.902256965637207,2.731547355651856,9.468698501586914;-8.442615509033203,0.522271394729614,10.229598999023438;-9.120141983032227,-3.310870170593262,10.662628173828125;-7.283654689788818,-0.654419779777527,8.502375602722168;-6.865743637084961,1.409414291381836,7.974555969238281;-6.360549926757812,0.410829216241837,8.07313060760498;-6.46658992767334,0.891516089439392,7.946788787841797;-6.240138053894043,0.782721161842346,7.963938236236572;-6.258647441864014,1.252476811408997,7.908699035644531;-6.079293251037598,1.340270042419434,7.94834566116333;-5.990031242370606,1.624042868614197,7.904222965240478;-5.938534259796143,1.836654305458069,7.82489824295044;-6.024185180664062,1.69662082195282,7.785885334014893;-6.230539321899414,1.435533881187439,7.762824535369873;-6.122378349304199,1.412724733352661,7.741896629333496;-6.081238746643066,1.296417832374573,7.709284782409668;-6.042168140411377,1.306716918945312,7.700740814208984;-6.092781066894531,1.262159585952759,7.689473628997803;-6.018857479095459,1.440996050834656,7.618247985839844;-5.921968460083008,1.517874121665955,7.601635456085205;-5.903982639312744,1.673994660377502,7.531127452850342;-5.865380764007568,1.747607588768005,7.476081848144531;-5.908823013305664,1.873624444007874,7.479323863983154;-5.770053863525391,1.792806267738342,7.415570735931396;-6.182243347167969,1.728479266166687,7.388027667999268;-6.252793312072754,1.186830759048462,7.401564121246338;-5.924610137939453,1.452089071273804,7.46750545501709;-6.476687431335449,1.022899150848389,7.529006481170654;-6.529643058776856,1.635856628417969,7.279643058776856;-6.158544063568115,0.338242053985596,7.528300762176514;-6.240736484527588,0.665841937065124,7.442067623138428;-6.318113803863525,0.745101690292358,7.483368873596191;-6.277868747711182,0.667745471000671,7.484803676605225;-6.470809459686279,0.682042598724365,7.432315826416016;-6.351412296295166,0.703227818012238,7.448246955871582;-6.350235462188721,0.825013160705566,7.396796703338623;-6.226725101470947,0.875479161739349,7.449392318725586;-6.185750961303711,0.905286729335785,7.46770429611206;-6.080718040466309,1.043160319328308,7.529292106628418;-5.990824222564697,1.210041522979736,7.59522008895874;-6.026449203491211,1.182748079299927,7.525838375091553;-6.059560775756836,0.941179156303406,7.517975807189941;-6.125019073486328,0.747856020927429,7.494350910186768;-6.190181732177734,0.893048286437988,7.438313484191894;-6.19917106628418,1.056090116500854,7.364497661590576;-6.251331806182861,1.196600675582886,7.235690116882324;-6.393319129943848,1.082553505897522,7.16556453704834;-6.58534574508667,0.975093424320221,7.201189041137695;-6.67437744140625,1.151609539985657,7.036983966827393;-6.707903385162354,1.62603223323822,6.756808280944824;-6.757317543029785,1.632655262947082,6.291688442230225;-7.377480030059814,1.482565879821777,6.145518779754639;-7.811983585357666,3.000858783721924,6.557992458343506;-8.896575927734375,4.431907176971436,7.80153751373291;-11.619821548461914,5.34764289855957,9.035795211791992;-14.558745384216309,3.712987899780273,9.585434913635254;-16.985639572143555,4.822922229766846,10.489543914794922;-19.7857723236084,4.459017276763916,11.728918075561523;-21.48462677001953,3.506908655166626,12.023598670959473;-21.034385681152344,3.372158527374268,10.437681198120117;-21.02754020690918,4.998960494995117,12.349666595458984;-18.745960235595703,7.028292179107666,16.201581954956055;-12.888808250427246,5.124478340148926,19.438026428222656;-24.71965217590332,5.637442111968994,22.373363494873047;-29.114032745361328,11.93044376373291,32.79487228393555;-17.390958786010742,14.645456314086914,24.018512725830078;-9.782958030700684,13.673080444335938,16.29804039001465;-3.711228847503662,11.636393547058105,10.187746047973633;0.120071679353714,8.89547348022461,6.633161067962646;1.533344388008118,6.85785722732544,5.193904876708984;1.228356719017029,5.584700584411621,5.252784729003906;-0.141808182001114,5.058567047119141,6.079070568084717;-1.76008927822113,5.198600769042969,7.02786111831665;-3.196925163269043,5.867269039154053,7.644610404968262;-4.501779079437256,6.430681705474854,7.924196243286133;-5.963178634643555,6.392765045166016,8.346467018127441;-7.547793388366699,6.004846096038818,8.628946304321289;-8.425901412963867,5.215454578399658,8.544261932373047;-8.706986427307129,4.434606552124023,7.922195434570312;-8.78412914276123,3.707805871963501,7.377218723297119;-9.350530624389648,3.061678171157837,7.221586227416992;-10.077606201171875,1.867711067199707,7.808561325073242;-11.510574340820312,2.141938924789429,7.857806205749512;-13.382664680480957,1.206784725189209,9.34730339050293;-13.90662956237793,-0.551730394363403,10.266362190246582;-14.230647087097168,-0.646448254585266,10.019659042358398;-14.73205852508545,-0.115393713116646,9.978291511535645;-16.59295654296875,0.595929265022278,10.623011589050293;-20.30725860595703,2.023541927337646,12.142009735107422;-25.217517852783203,3.102876663208008,13.911786079406738;-30.614505767822266,2.852925300598144,14.88823413848877;-34.11389923095703,1.424691438674927,13.136155128479004;-34.44220733642578,-0.776403784751892,7.889888763427734;-32.7462272644043,-3.277294158935547,0.673577308654785;-30.717613220214844,-5.566469669342041,-5.844658374786377;-28.440805435180664,-6.931612968444824,-11.083447456359863;-26.31910514831543,-7.500192165374756,-16.14826774597168;-29.781814575195312,-10.759142875671387,-20.466808319091797;-32.4423828125,-15.516536712646484,-25.049612045288086;-28.782581329345703,-14.20748233795166,-29.59151268005371;-23.614673614501953,-9.453065872192383,-29.569690704345703;-16.866132736206055,-0.33160412311554,-27.03800392150879;-7.399986743927002,-6.916891574859619,0.07284389436245;-3.891107797622681,5.247880935668945,21.427757263183594;2.172027826309204,4.842654705047607,17.048412322998047;1.264240026473999,-6.121435642242432,6.451839447021484;-11.114212989807129,-7.90290117263794,6.21766996383667;-19.681781768798828,-8.916802406311035,13.448387145996094;-20.022226333618164,-6.148005485534668,17.184097290039062;-29.217824935913086,14.715620040893555,19.108827590942383;-14.409513473510742,7.368215560913086,7.13551139831543;-10.994940757751465,-4.60895299911499,12.723686218261719;-9.753056526184082,-2.491865158081055,10.128560066223145;-10.212279319763184,4.349717617034912,9.919220924377441;-9.468389511108398,-1.810863494873047,11.795140266418457;-7.568025588989258,-2.738260746002197,8.910036087036133;-7.292670726776123,0.188088640570641,8.17097282409668;-7.169790744781494,-0.078035771846771,8.004636764526367;-6.561566352844238,0.154691562056541,7.996555328369141;-6.537824153900146,0.179381743073463,8.033849716186523;-6.16871976852417,0.764258563518524,7.94183874130249;-6.279455184936523,0.789465844631195,7.972439289093018;-6.054800510406494,0.975319385528564,7.986477375030518;-6.008358478546143,1.168373942375183,7.95338773727417;-5.885890007019043,1.557341814041138,7.858862400054932;-5.959338665008545,1.607438921928406,7.790562629699707;-6.033730983734131,1.336056590080261,7.796094417572022;-6.12588357925415,1.105821132659912,7.805858135223389;-6.205271244049072,0.846544563770294,7.803887844085693;-6.108922958374023,0.806520521640778,7.765544414520264;-5.892553329467773,1.072622537612915,7.757195949554443;-6.078053951263428,1.089461803436279,7.690299987792969;-6.163797855377197,0.983523488044739,7.609738349914551;-6.115487098693848,1.0670166015625,7.547659873962402;-6.10582447052002,1.086637854576111,7.530847072601318;-6.114957332611084,1.049978256225586,7.518435955047607;-5.889880180358887,1.18225908279419,7.569194793701172;-6.250938415527344,1.016381621360779,7.465410232543945;-5.990736484527588,1.343995451927185,7.385128974914551;-6.076604843139648,0.6146040558815,7.493721008300781;-6.474602699279785,1.312739133834839,7.384525775909424;-6.186129093170166,0.262356817722321,7.459275245666504;-6.226606845855713,0.739105701446533,7.388688564300537;-6.290219783782959,0.582338392734528,7.37236499786377;-6.202840805053711,0.763796329498291,7.423544406890869;-6.334332466125488,0.73513275384903,7.404806137084961;-6.388928413391113,0.824463248252869,7.351659297943115;-6.42935037612915,0.909122586250305,7.357522964477539;-6.38008975982666,0.878165602684021,7.36890459060669;-6.333049774169922,0.844742596149445,7.360703468322754;-6.209987640380859,0.900071024894714,7.452310562133789;-6.074863910675049,0.9994096159935,7.495412826538086;-6.064802646636963,0.9800705909729,7.495771408081055;-6.082187652587891,0.816655099391937,7.515079975128174;-6.110127449035644,0.726150095462799,7.504626274108887;];
Gyr_recortado=(180/pi)*[-0.382669925689697,-0.154875606298447,-0.639566838741302;-0.216434970498085,-0.188730001449585,-0.475487738847733;-0.191700756549835,-0.183967396616936,-0.403995126485825;-0.096485175192356,-0.10301186144352,-0.309123069047928;-0.036815635859966,-0.035037130117416,-0.200669541954994;0.021026730537415,0.024322396144271,-0.132976680994034;0.018629616126418,0.068509459495544,-0.103677004575729;0.033005185425282,0.123471967875957,-0.095876172184944;0.01105238776654,0.149984046816826,-0.119287550449371;-0.019680814817548,0.168106138706207,-0.169188275933266;-0.056865833699703,0.153554543852806,-0.205093547701836;-0.070367470383644,0.157312467694283,-0.234214216470718;-0.083085209131241,0.155128717422485,-0.239605620503426;-0.056142333894968,0.153836995363235,-0.221237495541573;-0.033219009637833,0.174245402216911,-0.193839773535728;-0.018708167597651,0.195746421813965,-0.200953230261803;-0.005241380538791,0.219308599829674,-0.218337714672089;-0.008398281410336,0.228762701153755,-0.221419423818588;-0.011477885767817,0.236548230051994,-0.251647025346756;0.009288719855249,0.250147938728332,-0.26753506064415;0.010357275605202,0.254244327545166,-0.283874124288559;0.003482645610347,0.261061131954193,-0.299980789422989;0.009813097305596,0.275823831558228,-0.323020279407501;-0.024897383525968,0.310712397098541,-0.356907457113266;-0.035480238497257,0.284484624862671,-0.382073909044266;-0.032651219516993,0.303218483924866,-0.400227338075638;-0.013573095202446,0.326853543519974,-0.380616873502731;-0.022971807047725,0.377102851867676,-0.364940017461777;-0.007120963651687,0.41746398806572,-0.346175730228424;0.003657887689769,0.444929450750351,-0.327018618583679;0.021866790950298,0.49072852730751,-0.315865606069565;0.038348633795977,0.551715016365051,-0.321901112794876;0.019456777721643,0.624362230300903,-0.304813355207443;0.020386975258589,0.704687178134918,-0.288608908653259;0.004358312115073,0.827090799808502,-0.281434625387192;0.011849434114993,0.989841103553772,-0.290675967931747;0.046573542058468,1.174229621887207,-0.304326802492142;0.0827861353755,1.363574743270874,-0.302690953016281;0.107461802661419,1.578540086746216,-0.247414827346802;0.115178979933262,1.817998886108398,-0.207920536398888;0.136784106492996,2.110495567321777,-0.19133223593235;0.160904943943024,2.448684930801392,-0.210192739963532;0.162332937121391,2.800576210021973,-0.284129798412323;0.15915048122406,3.215221643447876,-0.398626863956451;0.168506428599358,3.689684152603149,-0.545185446739197;0.267809182405472,4.245802879333496,-0.750670373439789;0.331252008676529,4.982869148254394,-0.991688847541809;0.331878453493118,5.858200073242188,-1.218491911888123;0.027261901646852,6.82038402557373,-1.600788474082947;-0.356161683797836,7.471315383911133,-2.095202207565308;-0.275521159172058,7.465251445770264,-2.475300073623657;-0.01707967184484,7.458494186401367,-2.792202234268188;0.068206392228603,7.456910610198975,-2.896970748901367;0.304073095321655,7.459410190582275,-2.895780563354492;0.513848304748535,7.242932796478272,-2.930696249008179;0.587797284126282,6.998561382293701,-2.992072582244873;0.873788356781006,6.32978630065918,-2.841191053390503;1.033762216567993,5.636523723602295,-2.83192777633667;1.353299498558044,4.827761650085449,-2.423035144805908;1.870964646339416,2.060185432434082,-1.4532390832901;1.463767290115356,-0.698912024497986,-0.82932847738266;0.343078076839447,-2.415504693984985,-0.501819491386414;-0.781708002090454,-3.190995454788208,-0.36112055182457;-1.331631898880005,-3.359253168106079,-0.132704764604568;-1.251521110534668,-3.2608642578125,0.270672351121902;-0.814109861850738,-3.094125270843506,0.74580043554306;-0.243604704737663,-3.016830444335938,1.227492809295654;0.253637671470642,-3.050666570663452,1.615588426589966;0.602415382862091,-3.213832139968872,1.893201351165772;0.773650467395782,-3.424277305603027,2.097646474838257;0.798007726669312,-3.754706144332886,2.245535135269165;0.7595055103302,-4.203477382659912,2.396148204803467;0.662349998950958,-4.723162174224854,2.519410133361816;0.541399478912354,-5.115556240081787,2.60414457321167;0.441694349050522,-5.357341766357422,2.641457557678223;0.402384281158447,-5.425593852996826,2.629550457000732;0.470980882644653,-5.461023330688477,2.672114133834839;0.616861164569855,-5.535236358642578,2.702935457229614;0.786259591579437,-5.691903114318848,2.700149536132812;0.929175555706024,-5.89488697052002,2.650198221206665;1.111510157585144,-6.033788204193115,2.548091411590576;1.30568253993988,-6.023829460144043,2.438306570053101;1.534136652946472,-5.896994590759277,2.355969905853272;1.785877823829651,-5.723441123962402,2.362602949142456;1.914555191993713,-5.608937740325928,2.468699932098389;1.866948366165161,-5.579311847686768,2.694611072540283;1.617678046226502,-5.721517562866211,2.971572399139404;1.258102297782898,-5.930037498474121,3.264666318893433;0.913812696933746,-5.981138706207275,3.474010467529297;0.66057538986206,-5.663012981414795,3.545879364013672;0.408557027578354,-5.018771171569824,3.412864685058594;0.000873868062627,-4.303902626037598,3.012051820755005;-0.86404275894165,-3.455305099487305,1.70266854763031;-0.680383682250977,-2.21907639503479,0.52211332321167;1.594727158546448,-0.993385314941406,0.841092824935913;2.801258563995361,0.3825543820858,1.501711845397949;1.217884302139282,1.803635358810425,1.232057929039002;-0.805404901504517,3.536784887313843,-0.238065034151077;-0.336080998182297,3.286350727081299,-0.86100971698761;-1.379445314407349,2.596361398696899,-1.766330480575562;-1.659520745277405,2.870729684829712,-2.331252098083496;-1.613409876823425,3.921201705932617,-2.148504972457886;-1.387194991111755,4.197971343994141,-1.378613233566284;-1.170667290687561,3.758510112762451,-1.01918351650238;-2.47836446762085,2.48832368850708,-1.978733420372009;-2.486103534698486,1.705858588218689,-1.801070690155029;-2.236350536346436,1.529918789863586,-1.400429844856262;-1.720141291618347,1.195515394210815,-1.231133341789246;-1.45164430141449,0.845929563045502,-1.062083005905151;-1.241361379623413,0.537714779376984,-0.802910447120666;-0.743948578834534,0.184573546051979,-0.636462152004242;-0.303909808397293,-0.116470232605934,-0.459537655115128;-0.167763859033585,-0.146596550941467,-0.367632955312729;-0.119782723486423,-0.128896325826645,-0.336764484643936;-0.051596470177174,-0.05992740765214,-0.237242564558983;-0.018698709085584,0.004615157842636,-0.166416361927986;0.017637509852648,0.05429795384407,-0.128148123621941;0.034577529877424,0.122444570064545,-0.101456485688686;0.039504121989012,0.186972260475159,-0.100330337882042;0.062793396413326,0.233143985271454,-0.109795369207859;0.061710305511951,0.261828064918518,-0.120003215968609;0.057152688503265,0.283704906702042,-0.115859925746918;0.058138135820627,0.300871193408966,-0.100337237119675;0.09000176936388,0.310750603675842,-0.078126005828381;0.1084089204669,0.33586397767067,-0.07848559319973;0.127740547060966,0.352167785167694,-0.079083077609539;0.097564436495304,0.363004505634308,-0.110226318240166;0.072365365922451,0.347631573677063,-0.178834185004234;0.050955019891262,0.343258440494537,-0.250087946653366;0.01078524440527,0.298242717981338,-0.348879873752594;0.013060760684311,0.278032898902893,-0.394242346286774;0.029115449637175,0.273153334856033,-0.476294636726379;-0.009121313691139,0.256160914897919,-0.551194250583649;-0.078888975083828,0.308345079421997,-0.581919729709625;-0.071975536644459,0.347245573997498,-0.501919984817505;-0.091972157359123,0.316184550523758,-0.47998034954071;-0.048531979322433,0.345704257488251,-0.4062719643116;-0.03727750480175,0.363474696874619,-0.333554804325104;-0.022440824657679,0.380374521017075,-0.277681797742844;0.005252399016172,0.414947748184204,-0.254702419042587;0.019914172589779,0.440475285053253,-0.240926966071129;0.068452216684818,0.479638636112213,-0.241910055279732;0.078306615352631,0.538342893123627,-0.22960464656353;0.089656852185726,0.620009660720825,-0.241379126906395;0.089858718216419,0.693962156772614,-0.217585533857346;0.079700589179993,0.816226303577423,-0.207486003637314;0.064901940524578,0.973794341087341,-0.223027616739273;0.062189612537622,1.163445949554443,-0.225430265069008;0.098374798893929,1.354278087615967,-0.235682711005211;0.149704217910767,1.591863989830017,-0.232769370079041;0.189526200294495,1.846320748329163,-0.191004291176796;0.199423998594284,2.145432233810425,-0.189397662878036;0.228737831115723,2.476541042327881,-0.236533001065254;0.255796194076538,2.863355398178101,-0.30070698261261;0.254959344863892,3.281527280807495,-0.377741605043411;0.213451340794563,3.770898342132568,-0.505408108234406;0.158153414726257,4.352689743041992,-0.655556857585907;0.177512049674988,5.065820217132568,-0.855313301086426;0.094852223992348,5.937179088592529,-1.156423449516296;-0.219758972525597,6.950595855712891,-1.640497326850891;-0.515150725841522,7.470447063446045,-2.192408084869385;-0.306281983852386,7.463342189788818,-2.541136741638184;0.118030980229378,7.456581592559814,-2.83144736289978;0.249409928917885,7.454229354858398,-2.988042116165161;0.512772798538208,7.455868721008301,-3.013145685195923;0.818445682525635,7.395590305328369,-3.019520282745361;1.139968633651733,7.157559871673584,-2.972081422805786;1.596921920776367,6.223794460296631,-2.713373184204102;1.977310061454773,5.057910442352295,-2.542795181274414;2.440682888031006,3.649661779403686,-2.018703937530518;2.671481370925903,0.497370302677155,-1.207005500793457;1.601525187492371,-1.917059659957886,-0.906736791133881;0.050409529358149,-3.120396375656128,-0.83227527141571;-1.069730520248413,-3.524873495101929,-0.710156202316284;-1.403823494911194,-3.533033847808838,-0.406347155570984;-1.150597929954529,-3.325404167175293,0.085908837616444;-0.567771673202515,-3.164860725402832,0.645975410938263;0.051219925284386,-3.202805757522583,1.188391923904419;0.492163389921188,-3.437938213348389,1.611729860305786;0.656316459178925,-3.758342742919922,1.921128869056702;0.619603931903839,-4.119753360748291,2.142770290374756;0.449570953845978,-4.488466739654541,2.29408073425293;0.253477513790131,-4.885011196136475,2.438771963119507;0.091077856719494,-5.25921630859375,2.599086999893188;-0.006761659868062,-5.516868591308594,2.740866422653198;-0.05881741642952,-5.633898258209228,2.872209548950195;0.005825895350426,-5.674437522888184,2.968894004821777;0.050844766199589,-5.660648822784424,3.06184196472168;0.138933330774307,-5.646215438842773,3.139672994613648;0.260559648275375,-5.655742645263672,3.194369554519653;0.452253013849258,-5.6815185546875,3.15765380859375;0.646450519561768,-5.678868770599365,3.086027145385742;0.802522242069244,-5.670711994171143,3.00199031829834;0.995458841323852,-5.730580806732178,2.935108184814453;1.164032578468323,-5.856840133666992,2.953661918640137;1.238191843032837,-5.980977535247803,2.97870397567749;1.23492693901062,-6.044632911682129,2.965478181838989;1.219947934150696,-6.068994522094727,2.89710259437561;1.187413096427918,-6.043200492858887,2.658143043518066;1.099942445755005,-5.834657192230225,2.257025241851807;1.035953521728516,-5.330004692077637,1.794274210929871;0.982057511806488,-4.600649833679199,1.302513480186462;1.108740925788879,-3.79513692855835,0.90185284614563;1.781458020210266,-3.062761306762695,0.918451130390167;2.426024913787842,-2.144927978515625,1.2950679063797;1.868855834007263,-0.822703003883362,1.341113209724426;0.146246522665024,0.624184906482696,0.692082345485687;-1.734251379966736,2.432624816894531,-0.641063630580902;-1.936573624610901,3.758397817611694,-1.889090538024902;-1.762470960617065,3.263426542282104,-2.062591552734375;-1.945731163024902,2.812599420547485,-2.084153890609741;-1.305426239967346,3.6332106590271,-1.70996367931366;-1.027280211448669,4.482011318206787,-1.211874961853027;-0.669365704059601,4.152613639831543,-0.704049646854401;-0.751272678375244,3.581665277481079,-1.035877585411072;-1.849047183990478,2.006232976913452,-1.580862522125244;-2.337630033493042,1.805115818977356,-1.23543906211853;-2.033922910690308,1.466469764709473,-1.115009188652039;-1.521673917770386,1.105994820594788,-1.098316311836243;-1.387223362922668,0.838772058486938,-0.880315124988556;-1.160698294639587,0.500546872615814,-0.746565699577332;-0.630079627037048,0.11528592556715,-0.596392273902893;-0.277882039546967,-0.109272547066212,-0.447286933660507;-0.171468243002892,-0.101404041051865,-0.380817502737045;-0.108170814812183,-0.045225959271193,-0.317382216453552;-0.002908947877586,0.01891122572124,-0.217707127332687;0.027093980461359,0.085502780973911,-0.130494251847267;0.077943712472916,0.114959947764874,-0.079740300774574;0.099800400435925,0.17395444214344,-0.047932676970959;0.11279072612524,0.225770890712738,-0.039453897625208;0.101375445723534,0.255541294813156,-0.068021602928638;0.085096076130867,0.255747348070145,-0.10341788828373;0.070834785699844,0.263513743877411,-0.118171788752079;0.087490610778332,0.275445759296417,-0.121705763041973;0.074973329901695,0.282497197389603,-0.093902789056301;0.096135266125202,0.297971725463867,-0.081095047295094;0.091555394232273,0.300454467535019,-0.082182630896568;0.079158335924149,0.30258110165596,-0.101693004369736;0.048882719129324,0.280607342720032,-0.162921607494354;0.017887556925416,0.251000165939331,-0.23610408604145;-0.010251087136567,0.209741994738579,-0.323200047016144;-0.02095839381218,0.167980626225472,-0.410355925559998;-0.040843922644854,0.14384451508522,-0.483960270881653;-0.015380865894258,0.132636070251465,-0.516704976558685;0.036113448441029,0.135822176933289,-0.514978229999542;-0.00156501471065,0.17251144349575,-0.498612463474274;-0.049674585461617,0.137887105345726,-0.45874872803688;-0.026569277048111,0.138604089617729,-0.412471890449524;-0.030079202726483,0.168036624789238,-0.326498627662659;-0.014388466253877,0.190303638577461,-0.282032191753387;-0.015734616667032,0.230705842375755,-0.250974327325821;0.003204719163477,0.284285396337509,-0.25502073764801;0.038859240710735,0.354722142219543,-0.237501963973045;0.065296322107315,0.428314834833145,-0.220188915729523;0.061150066554546,0.515386641025543,-0.197665557265282;0.065128900110722,0.604629397392273,-0.17022217810154;0.090581320226192,0.726774990558624,-0.139303117990494;0.119217216968536,0.896472990512848,-0.108634516596794;0.127002105116844,1.08670449256897,-0.113960608839989;0.147494077682495,1.306458592414856,-0.142474174499512;0.155353263020515,1.53721559047699,-0.14024144411087;0.190251961350441,1.822934150695801,-0.123456947505474;0.234987124800682,2.131247520446777,-0.125411063432693;0.279425263404846,2.455279111862183,-0.132232338190079;0.324668139219284,2.806164503097534,-0.177047044038773;0.362391203641892,3.190791130065918,-0.230679824948311;0.390161842107773,3.618925094604492,-0.290660619735718;0.312964051961899,4.12798023223877,-0.418439596891403;0.218727871775627,4.723100185394287,-0.578375101089478;0.098634243011475,5.455782413482666,-0.799947023391724;-0.158069506287575,6.303840637207031,-1.148802757263184;-0.45036318898201,7.174304962158203,-1.6345134973526;-0.557547450065613,7.474213600158691,-2.092731237411499;-0.259736388921738,7.467126846313477,-2.421931982040405;-0.038152992725372,7.458759784698486,-2.779059171676636;0.00769590260461,7.456465721130371,-2.968050241470337;0.304603606462479,7.386544704437256,-2.998766422271728;0.597086131572723,7.141500473022461,-3.052216291427612;0.943410634994507,6.809752941131592,-2.941016912460327;1.38034200668335,5.983591556549072,-2.737526893615723;1.824292898178101,5.064248085021973,-2.507976770401001;2.294128179550171,3.486130714416504,-1.887168049812317;2.288470506668091,0.390119671821594,-1.154370546340942;1.253176331520081,-1.792772769927978,-0.894294321537018;-0.109559930860996,-2.965611219406128,-0.829456329345703;-1.179885268211365,-3.378103733062744,-0.78420490026474;-1.575187563896179,-3.391546249389648,-0.542690873146057;-1.39384913444519,-3.237941980361938,-0.158731818199158;-0.932745158672333,-3.059730291366577,0.296826899051666;-0.326950311660767,-3.003204584121704,0.782106161117554;0.199827581644058,-3.123422861099243,1.253772616386414;0.511207699775696,-3.365402460098267,1.631341934204102;0.53566986322403,-3.699382066726685,1.89123010635376;0.386937081813812,-4.079798221588135,2.094725608825684;0.146830141544342,-4.498558521270752,2.275620698928833;-0.109442695975304,-4.888931751251221,2.424923896789551;-0.251641094684601,-5.195860862731934,2.544891119003296;-0.318818777799606,-5.42977237701416,2.682216882705688;-0.270966053009033,-5.578768253326416,2.846198320388794;-0.238701820373535,-5.652801990509033,2.93516206741333;-0.091660641133785,-5.696476459503174,3.074073314666748;-0.06100982427597,-5.697590351104736,3.097503662109375;0.135322257876396,-5.743522644042969,3.114520072937012;0.496088176965714,-5.812422752380371,3.104251623153686;0.765781044960022,-5.860868453979492,3.033132314682007;0.953251481056213,-5.88179349899292,2.95594310760498;1.069506883621216,-5.863601207733154,2.924075841903686;1.153842091560364,-5.863067626953125,2.955008745193481;1.193036437034607,-5.898281574249268,3.075608730316162;1.252326607704163,-5.980692863464356,3.231200456619263;1.309184670448303,-6.020590782165527,3.253827571868896;1.328418731689453,-5.868659496307373,3.042666912078857;1.280305743217468,-5.490971088409424,2.619701385498047;1.121273756027222,-4.94197416305542,2.06100606918335;0.947465300559998,-4.288072109222412,1.355405926704407;1.091505646705627,-3.59568977355957,0.669038474559784;1.980430364608765,-2.813696384429932,0.56566709280014;2.65933895111084,-1.659465670585632,0.836206555366516;1.835588335990906,-0.089401826262474,0.584286093711853;-0.523440062999725,1.740600347518921,-0.434506565332413;-2.110633373260498,3.704361915588379,-1.806733727455139;-1.576139569282532,3.508326530456543,-1.807295441627502;-2.294697999954224,3.006847858428955,-2.090651512145996;-2.095222473144531,3.408484220504761,-2.243800640106201;-1.705344557762146,4.235170841217041,-1.747701406478882;-1.20914888381958,4.156857967376709,-1.159509897232056;-1.056706547737122,3.55781364440918,-1.181785821914673;-2.057870864868164,1.878038763999939,-1.891905307769775;-2.254467010498047,1.608161211013794,-1.551947712898254;-1.974395513534546,1.413586020469666,-1.177493095397949;-1.489743590354919,1.061377286911011,-1.114598751068115;-1.36085844039917,0.767390310764313,-0.891884803771973;-1.222836375236511,0.466833800077438,-0.755520343780518;-0.698777973651886,0.029988180845976,-0.655885279178619;-0.311978459358215,-0.159848347306252,-0.510437905788422;-0.211195945739746,-0.166801795363426,-0.428457319736481;-0.143664315342903,-0.131025120615959,-0.339258790016174;-0.036240462213755,-0.057907573878765,-0.23009292781353;0.031604319810867,0.032588254660368,-0.145491823554039;0.055927772074938,0.080412328243256,-0.067316628992558;0.088114529848099,0.140828967094421,-0.041563477367163;0.108532436192036,0.189250349998474,-0.00910693500191;0.096882045269012,0.211140528321266,-0.017991730943322;0.090557478368282,0.233431726694107,-0.055127423256636;0.062058810144663,0.252688378095627,-0.089531853795052;0.059109691530466,0.261263489723206,-0.12425435334444;0.065953485667706,0.263929069042206,-0.111001998186111;0.081077538430691,0.294049561023712,-0.084684364497662;0.10245593637228,0.309040933847427,-0.065587148070335;0.101121090352535,0.338842809200287,-0.066833160817623;0.094879694283009,0.338758170604706,-0.080245643854141;0.117947764694691,0.336510062217712,-0.089208252727985;0.124180749058723,0.307122766971588,-0.121160633862019;0.124048762023449,0.291250884532928,-0.155738100409508;0.126129999756813,0.280283451080322,-0.175523787736893;0.136594325304031,0.271584063768387,-0.248150110244751;0.155133992433548,0.236307859420776,-0.330369800329208;0.075946561992168,0.241087228059769,-0.367536336183548;0.018437761813402,0.270731896162033,-0.398727267980576;-0.033908154815435,0.220098435878754,-0.397899717092514;-0.037999622523785,0.206106007099152,-0.377440184354782;-0.032329738140106,0.213164791464806,-0.31641948223114;0.021057983860373,0.214593350887299,-0.264883458614349;0.054444886744022,0.224767878651619,-0.21244540810585;0.082930080592632,0.256499379873276,-0.185886383056641;0.107289671897888,0.307522386312485,-0.166856616735458;0.111188597977161,0.367863178253174,-0.136376917362213;0.128819361329079,0.435394406318665,-0.116845525801182;0.1312315762043,0.520144581794739,-0.071249984204769;0.152346774935722,0.631900668144226,-0.047327894717455;0.165698170661926,0.76920884847641,-0.025517856702209;0.190026998519897,0.918106138706207,-0.028755970299244;0.206954032182693,1.098763465881348,-0.046434935182333;0.237009197473526,1.301076292991638,-0.057773932814598;0.20836415886879,1.543920159339905,-0.076108954846859;0.220261186361313,1.821951746940613,-0.092524200677872;0.287764012813568,2.140771865844727,-0.108338497579098;0.357738047838211,2.473283290863037,-0.129030928015709;0.414987295866013,2.836206912994385,-0.149127811193466;0.470487773418426,3.211395978927612,-0.140069186687469;0.492617696523666,3.623634099960327,-0.131748169660568;0.433245480060577,4.119198322296143,-0.19117483496666;0.304511845111847,4.676760196685791,-0.318022638559341;0.085453674197197,5.372548580169678,-0.505329251289368;-0.093240812420845,6.221856117248535,-0.769900262355804;-0.143888518214226,7.003423690795898,-1.125638604164124;0.02904318459332,7.489026069641113,-1.518295764923096;0.237201198935509,7.482523918151856,-1.843819260597229;0.375167012214661,7.474156379699707,-2.213011980056763;0.398032248020172,7.469461917877197,-2.468142509460449;0.613684773445129,7.367215633392334,-2.562591791152954;0.769722759723663,7.123190879821777,-2.714448690414429;0.884087264537811,6.976414203643799,-2.845654487609863;1.287517428398132,6.429117202758789,-2.735921144485474;1.852107286453247,5.435712337493896,-2.492117643356323;2.305316686630249,4.387598991394043,-2.319678544998169;2.68772029876709,1.79538083076477,-1.546223998069763;2.027312994003296,-0.806493163108826,-1.231698870658874;0.951960682868958,-2.395488023757935,-1.120544791221619;-0.161518469452858,-3.232582569122314,-1.174376368522644;-1.045795679092407,-3.473720550537109,-1.235327363014221;-1.371805787086487,-3.461160182952881,-1.090095162391663;-1.27289867401123,-3.36752200126648,-0.779723227024078;-0.903649628162384,-3.272940158843994,-0.384302407503128;-0.396451860666275,-3.251661062240601,0.089098080992699;0.157668232917786,-3.313264608383179,0.582404613494873;0.595550417900085,-3.501999616622925,1.062773823738098;0.792189538478851,-3.736820697784424,1.455911755561829;0.72684895992279,-4.082211494445801,1.76289975643158;0.467279404401779,-4.476883888244629,1.99550473690033;0.153484717011452,-4.88620662689209,2.194142818450928;-0.091314889490604,-5.215543746948242,2.392497301101685;-0.191007450222969,-5.447779178619385,2.582804203033447;-0.137818887829781,-5.588901519775391,2.77056622505188;-0.00550600560382,-5.681801795959473,2.939084529876709;0.04249082878232,-5.80020809173584,3.048302412033081;0.218573093414307,-5.968061447143555,3.098903894424438;0.525098443031311,-6.172445774078369,3.145501136779785;0.817383408546448,-6.20734453201294,3.120426416397095;1.041033625602722,-6.10056209564209,3.003230333328247;1.296083688735962,-5.890571594238281,2.907219648361206;1.573521137237549,-5.659498691558838,2.916127681732178;1.746062994003296,-5.385307788848877,3.044812917709351;1.771738529205322,-5.179847240447998,3.246792316436768;1.723454833030701,-5.205005168914795,3.526440143585205;1.592955827713013,-5.336225032806396,3.718793869018555;1.282281637191772,-5.355947971343994,3.596957445144653;0.843784332275391,-5.169782161712646,3.223429203033447;0.471085220575333,-4.738032817840576,2.733994960784912;0.178581118583679,-4.050800800323486,2.184939861297607;0.035725634545088,-3.214645385742188,1.506354570388794;0.507544338703156,-2.471929550170898,1.090177893638611;1.337462067604065,-1.547818779945374,0.993082046508789;1.351296901702881,-0.218009069561958,0.681643962860107;0.136257633566856,1.268587589263916,-0.061686612665653;-1.18912923336029,3.070672988891602,-1.391482949256897;-0.9338498711586,2.917270421981812,-1.675991535186768;-1.627457618713379,2.605031728744507,-2.147990703582764;-1.591300368309021,3.290935516357422,-2.411477565765381;-1.383788108825684,4.333763599395752,-1.985148668289185;-1.043629884719849,4.161640167236328,-1.282008767127991;-2.602940559387207,2.786432504653931,-2.034858703613281;-2.686224937438965,1.558080077171326,-2.066214799880981;-2.441044569015503,1.565179347991943,-1.695294260978699;-1.814432859420776,1.184577465057373,-1.30333936214447;-1.360695242881775,0.873781681060791,-0.996476948261261;-1.198423147201538,0.661632478237152,-0.754607498645782;-1.057643294334412,0.442560195922852,-0.694998800754547;-0.593231797218323,0.032484330236912,-0.587428271770477;-0.220409601926804,-0.096783302724361,-0.421267807483673;-0.13184566795826,-0.081725239753723,-0.292788684368134;-0.082527004182339,-0.045658595860004,-0.234979465603828;-0.019993742927909,0.00221988116391,-0.155879944562912;0.042927239090204,0.069537535309792,-0.083518780767918;0.100550286471844,0.129443615674973,-0.028146836906672;0.104769490659237,0.163348942995071,-0.011460988782346;0.113922297954559,0.197588682174683,-0.016938706859946;0.09460174292326,0.22139510512352,-0.056958746165037;0.075068637728691,0.242658153176308,-0.092049069702625;0.053324140608311,0.253261417150497,-0.103629171848297;0.052585836499929,0.250833481550217,-0.083038195967674;0.061672445386648,0.252752482891083,-0.087080903351307;0.086124882102013,0.256499141454697,-0.082375220954418;0.087664864957333,0.270633518695831,-0.087693266570568;0.085703045129776,0.269567728042603,-0.084114857017994;0.087153658270836,0.269812673330307,-0.124920979142189;0.07646981626749,0.251806855201721,-0.179894745349884;0.044310677796602,0.238744050264359,-0.252780050039291;0.014389286749065,0.197273209691048,-0.347948431968689;-0.02302560210228,0.171863153576851,-0.415749251842499;-0.036784090101719,0.166124269366264,-0.48226210474968;-0.030046191066504,0.139222040772438,-0.524293303489685;-0.008824056945741,0.131293371319771,-0.530207753181458;-0.073938608169556,0.158863708376884,-0.519911289215088;-0.111722037196159,0.148820891976356,-0.504878222942352;-0.094022437930107,0.192112311720848,-0.457778990268707;-0.056259620934725,0.238320633769035,-0.381378173828125;-0.022100212052464,0.296454966068268,-0.333633214235306;-0.002597434446216,0.359103113412857,-0.276255518198013;0.024447517469525,0.398840248584747,-0.222956016659737;0.049379039555788,0.458443433046341,-0.168740063905716;0.059815272688866,0.512673795223236,-0.147012084722519;0.081077240407467,0.580344438552856,-0.138487249612808;0.081765376031399,0.69321882724762,-0.090542487800121;0.096338652074337,0.813211262226105,-0.089651212096214;0.096144914627075,0.977947056293488,-0.108750328421593;0.119369961321354,1.158252477645874,-0.122403025627136;0.145496428012848,1.373170018196106,-0.128762125968933;0.168722614645958,1.597150921821594,-0.092491298913956;0.223049253225327,1.856379151344299,-0.050701327621937;0.263020038604736,2.128750085830688,-0.03307119384408;0.296727329492569,2.457273006439209,-0.04928345605731;0.323615312576294,2.794779300689697,-0.094816289842129;0.369086354970932,3.147928714752197,-0.157770380377769;0.398007273674011,3.542269945144653,-0.210476770997047;0.323907881975174,3.995919704437256,-0.34561750292778;0.220337942242622,4.52655553817749,-0.513190150260925;0.161307528614998,5.195514678955078,-0.654603064060211;0.016941217705607,6.019233703613281,-0.849370956420898;-0.171987056732178,6.858414173126221,-1.195699453353882;-0.233106225728989,7.478534698486328,-1.634764313697815;0.008546868339181,7.478765964508057,-1.986516714096069;0.351761668920517,7.470879554748535,-2.317915916442871;0.341628223657608,7.465163230895996,-2.592472791671753;0.545299828052521,7.465083599090576,-2.6774582862854;0.762194752693176,7.25190019607544,-2.777942180633545;0.902674734592438,7.068477630615234,-2.917618274688721;1.169344544410706,6.367212295532227,-2.825985193252564;1.404964685440064,5.28594970703125,-2.621865034103394;1.769806981086731,4.080255508422852,-2.353755235671997;2.204645395278931,1.323834657669067,-1.494395732879639;1.59941565990448,-1.312149047851562,-1.102766871452332;0.59732186794281,-2.780972957611084,-0.9930459856987;-0.421213150024414,-3.431477308273315,-1.018698215484619;-1.036169171333313,-3.574541091918945,-0.936189651489258;-1.119472742080688,-3.463214635848999,-0.677855134010315;-0.805507361888886,-3.317205667495728,-0.28696858882904;-0.265934437513351,-3.26676607131958,0.220681622624397;0.303781479597092,-3.371532440185547,0.74527895450592;0.679455697536468,-3.618359565734863,1.203949093818665;0.745564997196198,-3.920155763626099,1.544603109359741;0.644513309001923,-4.26461124420166,1.822620749473572;0.468181222677231,-4.671236991882324,2.061883926391602;0.299031883478165,-5.066516876220703,2.293874502182007;0.17043462395668,-5.382524490356445,2.483916997909546;0.108630925416946,-5.573569774627686,2.649052619934082;0.122526280581951,-5.650694847106934,2.807962417602539;0.157097294926643,-5.700721740722656,2.899722814559936;0.210407003760338,-5.758532047271728,2.991199493408203;0.265116721391678,-5.830676078796387,2.992972135543823;0.600486159324646,-5.962648868560791,3.003997564315796;1.058085918426514,-5.969645023345947,2.935049057006836;1.399980187416077,-5.827023983001709,2.804916381835938;1.631367921829224,-5.603724956512451,2.654312133789062;1.782161593437195,-5.395760536193848,2.569483757019043;1.705581188201904,-5.390461444854736,2.558345794677734;1.576693892478943,-5.624778270721436,2.746721267700195;1.434333086013794,-6.031775951385498,3.070350170135498;1.253637790679932,-6.277105808258057,3.289829969406128;1.062095046043396,-6.12180233001709,3.221143007278442;0.893857181072235,-5.571686267852783,2.863204479217529;0.756251811981201,-4.7624831199646,2.386766910552978;0.607520699501038,-3.857075929641724,1.79712975025177;0.650779128074646,-3.017798662185669,1.193032503128052;1.387346863746643,-2.299335241317749,1.049049139022827;1.995021104812622,-1.223079562187195,1.215147018432617;1.263876557350159,0.345763027667999,0.93204927444458;-0.814598739147186,2.061458587646484,0.088209383189678;-2.492872714996338,3.792459487915039,-1.151738524436951;-2.054832220077515,3.511044502258301,-1.201779723167419;-2.800651550292969,3.288418531417847,-1.655949711799622;-2.232525110244751,3.894164562225342,-1.710718274116516;-1.683152079582214,4.451527118682861,-1.431365251541138;-1.094675660133362,4.054605484008789,-1.188289523124695;-0.641133308410644,3.475865125656128,-1.201533675193787;-1.83807897567749,1.90654981136322,-1.890176296234131;-2.213831424713135,1.542805433273315,-1.422715544700623;-1.987404823303223,1.316901564598084,-1.190910339355469;-1.430862903594971,0.92709356546402,-1.158868193626404;-1.280086517333984,0.639300763607025,-0.852795958518982;-1.057838201522827,0.261123418807983,-0.749878704547882;-0.53584760427475,-0.144372642040253,-0.720154464244842;-0.312747240066528,-0.203670009970665,-0.564375221729279;-0.232071056962013,-0.213421255350113,-0.479303330183029;-0.155337452888489,-0.168156564235687,-0.372568994760513;-0.075337991118431,-0.076109908521175,-0.249645888805389;-0.01746217533946,0.012121685780585,-0.163523152470589;0.017889818176627,0.071420952677727,-0.097839556634426;0.051337987184525,0.130789697170258,-0.042966943234205;0.063735730946064,0.195389062166214,-0.031066996976733;0.050790976732969,0.221399635076523,-0.055620297789574;0.030920583754778,0.238163575530052,-0.106410518288612;-0.001482701860368,0.248202830553055,-0.154771879315376;0.008236188441515,0.244658663868904,-0.17002409696579;0.003762318752706,0.242075130343437,-0.148736819624901;0.044809356331825,0.244314387440681,-0.1321761906147;0.054949123412371,0.276109606027603,-0.12625715136528;0.05291435495019,0.28815346956253,-0.134691789746284;0.06357891112566,0.288191139698029,-0.151045560836792;0.047330848872662,0.285202413797379,-0.160244733095169;0.058122754096985,0.274298906326294,-0.178670480847359;0.062795989215374,0.253090977668762,-0.19309838116169;0.059039656072855,0.26248025894165,-0.229406356811523;0.060690823942423,0.246817380189896,-0.276924461126328;0.052936386317015,0.242108449339867,-0.297591507434845;0.041511356830597,0.265922337770462,-0.322617530822754;0.044072743505239,0.251988351345062,-0.314049661159515;0.032994829118252,0.254202038049698,-0.304500102996826;0.047049656510353,0.279076874256134,-0.271880060434341;0.065812841057777,0.310501307249069,-0.23186519742012;0.06610295176506,0.341918140649796,-0.207546100020409;0.081224508583546,0.391757965087891,-0.207785174250603;0.089682631194592,0.417713612318039,-0.194225549697876;0.098556093871593,0.438118636608124,-0.185173764824867;0.087794832885265,0.49974399805069,-0.182701587677002;0.076949089765549,0.555147469043732,-0.184287220239639;0.07716192305088,0.66960859298706,-0.161229953169823;0.07436353713274,0.780996680259705,-0.176734194159508;0.073850370943546,0.940349340438843,-0.194502115249634;0.086714908480644,1.111562609672546,-0.201024323701859;0.095142856240273,1.320775270462036,-0.174669191241264;];
Acc_recortado=Acc_recortado(1:370,:); % m/s^2
Gyr_recortado=Gyr_recortado(1:370,:); % rad/s

% ...............Parámetros predefinidos de camninado PIE.................
SL_ini=1.3*(speed)^(1/3); % (Stride Length por defecto inicial) Longitud del paso (m) (depende algo de la velocidad)
SH=0.1;  % (Step Height) altura del pie [m]
Stance_fraction=0.40;  % fraccion del tiempo en un paso con apoyo del pie en el suelo (stance), el resto tiempo en swing. 
Pitch_max=70; %32[º]

if longitud>0
    num_muestras=floor((longitud/speed)*fs); % s (que sea un multiplo del tiempo de muestreo)
    num_segundos=num_muestras/fs; % s
    num_pasos=ceil((num_segundos*speed)/SL_ini); % calcular cuantos pasos necesito (numero entero)
    num_muestras_paso=floor(num_muestras/num_pasos); % quiero que sea entero
    num_muestras_mediostance=floor(0.5*num_muestras_paso*Stance_fraction);
    num_muestras_swing=num_muestras_paso-2*num_muestras_mediostance;
    num_muestras=num_muestras_paso*num_pasos;
    SL=longitud/num_pasos; % ver la longitud del paso final que se adapta a la trayectoria recta
else
    num_muestras=floor(speed*fs); % uso "speed" en este caso como el número de segundos parado (Still)
    num_segundos=num_muestras/fs; % s
    num_pasos=0;
end

% ................inicializo variables.................
Acc=zeros(num_muestras,3);     % en sistema referencia sensor S
Gyr=zeros(num_muestras,3);
Mag=zeros(num_muestras,3);
Pos_G=zeros(num_muestras,3);     % en sistema referencia global G
Vel_G=zeros(num_muestras,3);
Att_G=zeros(num_muestras,3);
Acc_G=zeros(num_muestras,3);
Stance=zeros(num_muestras,1);
StepDectSample=zeros(num_pasos+1,1);
Rot_GS=zeros(3,3,num_muestras); % matrices de rotacion de S a G
Rot_z=zeros(3,3,num_muestras);
Rot_y=zeros(3,3,num_muestras);
Rot_x=zeros(3,3,num_muestras);


%=======================================================================================
% 1) Construir trayectoria en G (Pos_G y Att_G) y sus derivadas (Vel_G,Acc_G y Gyr_G)
%=======================================================================================
% -------------------------------------------------------------------
% Posiciones "Pos_G" de IMU
if longitud>0 % no-Still
    i=1; % muestra (at sampling rate)
    StepDectSample(1)=1; % el primer paso ya es la posición inicial
    for j=1:num_pasos
        for k=1:num_muestras_mediostance  % medio stance inicial
            if j==1  % en el primer paso parto de pos inicial
                Pos_G(i,1)=Pos_G_ini(1);
                Pos_G(i,2)=Pos_G_ini(2);
                Pos_G(i,3)=Pos_G_ini(3);
            else  % en los otros pasos parto del paso anterior
                Pos_G(i,1)=Pos_G(i_fin_stance,1);
                Pos_G(i,2)=Pos_G(i_fin_stance,2);
                Pos_G(i,3)=Pos_G(i_fin_stance,3);
            end
            % Derivada de Pos (Vel) algebraicamnete
            Vel_G(i,1)=0;
            Vel_G(i,2)=0;
            Vel_G(i,3)=0;
            % Derivada de Vel (Ace) algebraicamnete
            Acc_G(i,1)=0;
            Acc_G(i,2)=0;
            Acc_G(i,3)=0;
            %----
            Stance(i)=1;
            i=i+1;
        end
        i_fin_stance=i-1;
        for k=1:num_muestras_swing  % fase de swing
            Forma_Avance=(SL/2)*(1-cos(pi*(k-0.5)/num_muestras_swing));
            Pos_G(i,1)=Pos_G(i_fin_stance,1)+cos(direccion*pi/180)*Forma_Avance;
            Pos_G(i,2)=Pos_G(i_fin_stance,2)+sin(direccion*pi/180)*Forma_Avance;
            Forma_Altura=(SH/2)*(1-cos(2*pi*(k-0.5)/num_muestras_swing));
            Pos_G(i,3)=Pos_G(i_fin_stance,3)+Forma_Altura;
            % Derivada de Pos (Vel) algebraicamnete
            Vel_G(i,1)=fs*(SL/2)*(pi/num_muestras_swing)*(sin(pi*(k-0.5)/num_muestras_swing))*cos(direccion*pi/180);
            Vel_G(i,2)=fs*(SL/2)*(pi/num_muestras_swing)*(sin(pi*(k-0.5)/num_muestras_swing))*sin(direccion*pi/180);
            Vel_G(i,3)=fs*(SH/2)*(2*pi/num_muestras_swing)*(sin(2*pi*(k-0.5)/num_muestras_swing));
            % Derivada de Vel (Ace) algebraicamnete
            Acc_G(i,1)=fs^2*(SL/2)*(pi/num_muestras_swing)^2*(cos(pi*(k-0.5)/num_muestras_swing))*cos(direccion*pi/180);
            Acc_G(i,2)=fs^2*(SL/2)*(pi/num_muestras_swing)^2*(cos(pi*(k-0.5)/num_muestras_swing))*sin(direccion*pi/180);
            Acc_G(i,3)=fs^2*(SH/2)*(2*pi/num_muestras_swing)^2*(cos(2*pi*(k-0.5)/num_muestras_swing));
            i=i+1;
        end
        i_fin_swing=i-1;
        StepDectSample(j+1)=i;
        for k=1:num_muestras_mediostance % medio stance final
            Pos_G(i,1)=Pos_G(i_fin_swing,1);
            Pos_G(i,2)=Pos_G(i_fin_swing,2);
            Pos_G(i,3)=Pos_G(i_fin_swing,3);
            % Derivada de Pos (Vel) algebraicamnete
            Vel_G(i,1)=0;
            Vel_G(i,2)=0;
            Vel_G(i,3)=0;
            % c
            Acc_G(i,1)=0;
            Acc_G(i,2)=0;
            Acc_G(i,3)=0;
            %----
            Stance(i)=1;
            i=i+1;
        end
        i_fin_stance=i-1;
    end % end-for num_pasos
    
else  % if longitud==0 (Still)
    for i=1:num_muestras
        Pos_G(i,1)=Pos_G_ini(1);
        Pos_G(i,2)=Pos_G_ini(2);
        Pos_G(i,3)=Pos_G_ini(3);
        % Derivada de Pos (Vel) algebraicamnete
        Vel_G(i,1)=0;
        Vel_G(i,2)=0;
        Vel_G(i,3)=0;
        % Derivada de Vel (Ace) algebraicamnete
        Acc_G(i,1)=0;
        Acc_G(i,2)=0;
        Acc_G(i,3)=0;
        Stance(i)=1;
    end
    StepDectSample=[];
end

% -------------------------------------------------------------------
% Rotaciones "Att_G" de IMU
if longitud>0 % Still
    i=1; % muestra (at sampling rate)
    for j=1:num_pasos
        for k=1:num_muestras_mediostance  % medio stance inicial
            if j==1  % en el primer paso parto de pos inicial
                Att_G(i,1)=Att_foot(1); %[º]
                Att_G(i,2)=Att_foot(2);
                Att_G(i,3)=Att_foot(3);
            else  % en los otros pasos parto del paso anterior
                Att_G(i,1)=Att_G(i_fin_stance,1);%[º]
                Att_G(i,2)=Att_G(i_fin_stance,2);
                Att_G(i,3)=Att_G(i_fin_stance,3);
            end
            %---
            i=i+1;
        end
        i_fin_stance=i-1;
        for k=1:num_muestras_swing  % fase de swing
            Att_G(i,1)=Att_G(i_fin_stance,1);  % roll:
            Forma_Pitch=Pitch_max*sin(2*pi*k/num_muestras_swing); %pitch:
            Att_G(i,2)=Att_G(i_fin_stance,2)+Forma_Pitch;
            Att_G(i,3)=Att_G(i_fin_stance,3); % yaw
            %---
            i=i+1;
        end
        i_fin_swing=i-1;
        for k=1:num_muestras_mediostance % medio stance final
            Att_G(i,1)=Att_G(i_fin_swing,1); %[º]
            Att_G(i,2)=Att_G(i_fin_swing,2);
            Att_G(i,3)=Att_G(i_fin_swing,3);
            %---
            i=i+1;
        end
        i_fin_stance=i-1;
    end
   
else  % if longitud==0 (Still)
    for i=1:num_muestras
        Att_G(i,1)=Att_foot(1); %[º]
        Att_G(i,2)=Att_foot(2);
        Att_G(i,3)=Att_foot(3);
    end
end

for i=1:num_muestras
    Att_G(i,3)=Att_G(i,3)+direccion; % le añado el Yaw de la direccion de la trayectoria
end


%---------------------------------------------------------------------------
% Si quiero Trayectoria curva => deformo la anterior recta creada
if abs(curvatura)>0 && longitud>0 %if trayectoria curva

    for i=1:num_muestras
        %plot(Pos_G(:,1),Pos_G(:,2),'*')
        %========Posicion X-Y============
        distancia=sqrt((Pos_G(i,1)-Pos_G_ini(1))^2+(Pos_G(i,2)-Pos_G_ini(2))^2);
        %X
        Pos_G(i,1)=1/curvatura*(sin(distancia*curvatura))+Pos_G_ini(1);
        %Y
        Pos_G(i,2)=1/curvatura*(1-cos(distancia*curvatura))+Pos_G_ini(2);
        % Rotar trayectoria circular según direccion de avance de la trayectoria recta
        Pos_G(i,1:2)=[cos(direccion*pi/180) -sin(direccion*pi/180); sin(direccion*pi/180) cos(direccion*pi/180)]*(Pos_G(i,1:2)-Pos_G_ini(1:2))';
        Pos_G(i,1:2)=Pos_G(i,1:2)+Pos_G_ini(1:2);
        %========Velocidad X-Y============
        velocidad=sqrt(Vel_G(i,1)^2+Vel_G(i,2)^2);
        if Vel_G(i,1)==0
            signoX=((Vel_G(i,2)>0)-0.5)*2; % cojo el signo de la componente que si tiene aceleracion distinta de cero
        else
            signoX=((Vel_G(i,1)>0)-0.5)*2; % vale 1 o -1 (sie el signo es + o -, respectivamente)
        end
        if Vel_G(i,2)==0
            signoY=((Vel_G(i,1)>0)-0.5)*2; % cojo el signo de la componente que si tiene aceleracion distinta de cero
        else
            signoY=((Vel_G(i,2)>0)-0.5)*2; % vale 1 o -1 (sie el signo es + o -, respectivamente)
        end
        if  signoX==1 && signoY==1 % si primer cuadrante
            Vel_G(i,1)=signoX*velocidad*(cos(distancia*curvatura));%X
            Vel_G(i,2)=signoY*velocidad*(sin(distancia*curvatura));%Y
        end
        if  signoX==-1 && signoY==1 % si 2º cuadrante
            Vel_G(i,1)=signoX*velocidad*(-cos(distancia*curvatura));%X (cambio signo aqui)
            Vel_G(i,2)=signoY*velocidad*(sin(distancia*curvatura));%Y
        end
        if  signoX==-1 && signoY==-1 % si 3º cuadrante
            Vel_G(i,1)=signoX*velocidad*(-cos(distancia*curvatura));%X (cambio signo aqui)
            Vel_G(i,2)=signoY*velocidad*(-sin(distancia*curvatura));%Y (cambio signo aqui)
        end
        if  signoX==1 && signoY==-1 % si 4º cuadrante
            Vel_G(i,1)=signoX*velocidad*(cos(distancia*curvatura));%X
            Vel_G(i,2)=signoY*velocidad*(-sin(distancia*curvatura));%Y (cambio signo aqui)
        end
        % Rotar trayectoria circular según direccion de avance de la trayectoria recta
        Vel_G(i,1:2)=[cos(direccion*pi/180) -sin(direccion*pi/180); sin(direccion*pi/180) cos(direccion*pi/180)]*Vel_G(i,1:2)';
        %========Aceleracion X-Y============
        %        % Método para derivar basado en la señal de Aceleracion generada algebraicamente (no funciona bien)
        %         aceleracion=sqrt(Acc_G(i,1)^2+Acc_G(i,2)^2);
        %         if Acc_G(i,1)==0
        %            signoX=((Acc_G(i,2)>0)-0.5)*2; % cojo el signo de la componente que si tiene aceleracion distinta de cero
        %         else
        %            signoX=((Acc_G(i,1)>0)-0.5)*2; % vale 1 o -1 (sie el signo es + o -, respectivamente)
        %         end
        %         if Acc_G(i,2)==0
        %            signoY=((Acc_G(i,1)>0)-0.5)*2; % cojo el signo de la componente que si tiene aceleracion distinta de cero
        %         else
        %            signoY=((Acc_G(i,2)>0)-0.5)*2; % vale 1 o -1 (sie el signo es + o -, respectivamente)
%         end
%         %X
%         Acc_G(i,1)=signoX*aceleracion*(cos(distancia*curvatura));
%         %Y
%         Acc_G(i,2)=signoY*aceleracion*(sin(distancia*curvatura));
%         % Rotar trayectoria circular según direccion de avance de la trayectoria recta
%         Acc_G(i,1:2)=[cos(direccion*pi/180) -sin(direccion*pi/180); sin(direccion*pi/180) cos(direccion*pi/180)]*Acc_G(i,1:2)';
        % -----------Método alternativo de derivar:diferenciación sobre velocidad para obtener la aceleracion (va bien)------------
        if i>1
           Acc_G(i,1:2)=fs*(Vel_G(i,1:2)-Vel_G(i-1,1:2));
        end
        %========Att3 (Yaw)============
        %(distancia*curvatura)*180/pi, % son los grados girados (pasados de radianes a grados)
        Att_G(i,3)=Att_G(i,3)+(distancia*curvatura)*180/pi;
    end
end



%========================================================================================
% 2) Transformar Acc_G y Att_G en las señales simulados de IMU: Acc, Gyr y Mag (en S)
%========================================================================================

% -------------------------------------------------------------------
% "Acc" de IMU en sistema referencia sensor (S)
for i=1:num_muestras
    % Calcular DCM
     Rot_z(:,:,i)=[cos(Att_G(i,3)*pi/180) -sin(Att_G(i,3)*pi/180) 0;  sin(Att_G(i,3)*pi/180) cos(Att_G(i,3)*pi/180) 0; 0 0 1];% from S-Sensor to G-Global
     Rot_y(:,:,i)=[cos(Att_G(i,2)*pi/180) 0 sin(Att_G(i,2)*pi/180); 0 1 0; -sin(Att_G(i,2)*pi/180)   0 cos(Att_G(i,2)*pi/180)];% from S-Sensor to G-Global
     Rot_x(:,:,i)=[1 0 0; 0 cos(Att_G(i,1)*pi/180) -sin(Att_G(i,1)*pi/180); 0  sin(Att_G(i,1)*pi/180) cos(Att_G(i,1)*pi/180)];% from S-Sensor to G-Global
     Rot_GS(:,:,i)=Rot_z(:,:,i)*Rot_y(:,:,i)*Rot_x(:,:,i);  % from S-Sensor to G-Global BUENA
     % trasformar aceleraciones
     Acc(i,:)=(Rot_GS(:,:,i)'*(Acc_G(i,:)+[0 0 gravedad])')'; % m/s2
end

% -------------------------------------------------------------------
% "Gyr" de IMU en sistema referencia sensor (S)
for i=1:num_muestras % trasformar giros (método Zampella)
    if i==1
        Gyr(1,:)=[0 0 0];
    else
        %Matriz_skew=fs*real(logm(Rot_GS(:,:,i)'*Rot_GS(:,:,i+1))); % rad/s
        Matriz_skew=fs*real(logm(Rot_GS(:,:,i-1)'*Rot_GS(:,:,i))); % rad/s (modificado)
        Gyr(i,1)=0.5*(-Matriz_skew(2,3)+Matriz_skew(3,2)); %rad/s
        Gyr(i,2)=0.5*(Matriz_skew(1,3)-Matriz_skew(3,1));
        Gyr(i,3)=0.5*(-Matriz_skew(1,2)+Matriz_skew(2,1));
    end
end


% -------------------------------------------------------------------
% "Mag" Crear medidas magnetometro y añadir perturbaciones si las hubiese:
if isempty(mom_dipolo)
    % caso ideal
    magnetic_G=[0.6 0 -0.25];  % valor arbitrario y aproximado al valor en España
    for i=1:num_muestras
        Mag(i,:)=(Rot_GS(:,:,i)'*magnetic_G')';
    end
else
    %      mom_dipolo:      [kx3] momento(s) dipolar(es) perturbacion(es); donde k es numero dipolos magneticos perturbadores
    %      pos_dipolo:      [kx3] posicion de los dipolos magneticos
    %      amp_osc_dipolo:  [k] amplitud de oscilacion en metros (poner amplitud cero para que no se muevan dipolos)
    %      dir_osc_dipolo:  [k] direccion oscilacion en grados respecto eje X
    %      fre_osc_dipolo:  [k] frecuencia de oscilacion en Hz (ciclos/segundo)
    
    for i=1:num_muestras
        magnetic_G=[0.6 0 -0.25];
        for k=1:size(mom_dipolo,1)
            % ver posicion de la IMU en ese instante
            r=Pos_G(i,1:3);
            % preparar posiciones desplazadas de los dipolos
            r_dipolo=pos_dipolo(k,1:3);
            r_osc=amp_osc_dipolo(k)*[cos(dir_osc_dipolo(k)*pi/180)*cos(2*pi*fre_osc_dipolo(k)*i/fs), sin(dir_osc_dipolo(k)*pi/180)*cos(2*pi*fre_osc_dipolo(k)*i/fs)];
            r_dipolo(1:2)=r_dipolo(1:2)+r_osc;
            % calcular campo magnetico extra de cada dipolo
            delta_r=r-r_dipolo;  % vector 1x3
            magnitud_delta_r=norm(delta_r); % escalar
            dot_product=dot(mom_dipolo(k,1:3),delta_r);  % producto escalar 
            magnetic_G_extra=(3*delta_r*dot_product)/(magnitud_delta_r^5)-(mom_dipolo(k,1:3)/(magnitud_delta_r^3));
            % acumular el campo magnetico extra
            magnetic_G=magnetic_G+magnetic_G_extra;
        end
        Mag(i,:)=(Rot_GS(:,:,i)'*magnetic_G')';
    end
end





%==============================================
% restos viejo algoritmo:
% 
% % añadir ruido
% bias_Acc=error_acel(1:3);
% ruido_Acc=error_acel(4);
% bias_Gyr=error_gyro(1:3);
% ruido_Gyr=error_gyro(4);
% num_muestras=size(Acc,1);  % recalculo "num_muestras"
% Acc=Acc + ones(num_muestras,1)*bias_Acc; % m/s^2
% Acc=Acc + randn(num_muestras,3)*ruido_Acc;  % m/s^2
% Gyr=Gyr + ones(num_muestras,1)*bias_Gyr; % rad/s
% Gyr=Gyr + randn(num_muestras,3)*ruido_Gyr;    % rad/s
% 
% 
% % Cargar datos reales
% Real.bias_Gyr=bias_Gyr'*ones(1,num_muestras);  % [3 x num_samples]
% Real.bias_Acc=bias_Acc'*ones(1,num_muestras);  % [3 x num_samples]
% Real.Vel=Vel_G([1:num_muestras],:)';                         % [3 x num_samples] Vx,Vy,Vz
% Real.Pos=Pos_G([1:num_muestras],:)';                         % [3 x num_samples] X,Y,Z
% Real.Att=Ang_G([1:num_muestras],:)';                         % [3 x num_samples] Attitude en roll,pitch y yaw
% 



%====================================================================================
%   visualizar
%======================================================================================




hay=[~isempty(Acc),~isempty(Gyr),~isempty(Mag)];
% Visualizar datos crudos
if ver
%     for i=1:4:num_muestras
%        visualizar_IMU(Rot_GS(:,:,i),i,idx_fig); %pause(0.05);
%     end
%     idx_fig=idx_fig+1;
    
    figure(idx_fig);
    plot3(Pos_G(:,1),Pos_G(:,2),Pos_G(:,3),'b-'); ylabel('PosyG'); zlabel('PoszG'); xlabel('PosxG'); % trayectoria ideal
    grid on; title('Position 3D:X-Y-Z en G (m)');    axis equal
    hold on; plot3(Pos_G(StepDectSample,1),Pos_G(StepDectSample,2),Pos_G(StepDectSample,3),'ro','MarkerSize',6,'MarkerFaceColor',[0 0 1]);
    if ver==2 % pintar tambien ejes rotados
        largo_eje=0.05; %m % Pintar ejes rotados
        for i=1:10:num_muestras
            u(i,:)=(Rot_GS(:,:,i)*[largo_eje 0 0]')'; v(i,:)=(Rot_GS(:,:,i)*[0 largo_eje 0]')'; w(i,:)=(Rot_GS(:,:,i)*[0 0 largo_eje]')';
            plot3([0 u(i,1)]+Pos_G(i,1),[0 u(i,2)]+Pos_G(i,2),[0 u(i,3)]+Pos_G(i,3),'r'); hold on;
            plot3([0 v(i,1)]+Pos_G(i,1),[0 v(i,2)]+Pos_G(i,2),[0 v(i,3)]+Pos_G(i,3),'g');
            plot3([0 w(i,1)]+Pos_G(i,1),[0 w(i,2)]+Pos_G(i,2),[0 w(i,3)]+Pos_G(i,3),'b');
            text(u(i,1)+Pos_G(i,1),u(i,2)+Pos_G(i,2),u(i,3)+Pos_G(i,3),'X');
            text(v(i,1)+Pos_G(i,1),v(i,2)+Pos_G(i,2),v(i,3)+Pos_G(i,3),'Y');
            text(w(i,1)+Pos_G(i,1),w(i,2)+Pos_G(i,2),w(i,3)+Pos_G(i,3),'Z');
        end
    end
    if exist('Pos_G_rec','var')
        plot3(Pos_G_rec(:,1),Pos_G_rec(:,2),Pos_G_rec(:,3),'r-'); %trayectoria reconstruida
        plot3(Pos_G_rec(StepDectSample,1),Pos_G_rec(StepDectSample,2),Pos_G_rec(StepDectSample,3),'ro','MarkerSize',6,'MarkerFaceColor',[1 0 0]);
    end
    if ~isempty(mom_dipolo)
       for k=1:size(mom_dipolo,1)
            plot3(pos_dipolo(k,1),pos_dipolo(k,2),pos_dipolo(k,3),'m*');
            plot3([pos_dipolo(k,1) pos_dipolo(k,1)+mom_dipolo(k,1)],...
                  [pos_dipolo(k,2) pos_dipolo(k,2)+mom_dipolo(k,2)],...
                  [pos_dipolo(k,3) pos_dipolo(k,3)+mom_dipolo(k,3)],'md-');
       end
    end
    idx_fig=idx_fig+1;hold off;
    
    figure(idx_fig);
    plot(Pos_G(:,1),Pos_G(:,2),'b-'); ylabel('PosyG'); xlabel('PosxG'); 
    title('Position X-Y en G (m)');
    axis equal
    hold on; 
    plot(Pos_G(StepDectSample,1),Pos_G(StepDectSample,2),'ro','MarkerSize',6,'MarkerFaceColor',[0 0 1]);
    if exist('Pos_G_rec','var')
        plot(Pos_G_rec(:,1),Pos_G_rec(:,2),'r-');
        plot(Pos_G_rec(StepDectSample,1),Pos_G_rec(StepDectSample,2),'ro','MarkerSize',6,'MarkerFaceColor',[1 0 0]);
    end
    if ~isempty(mom_dipolo)
       for k=1:size(mom_dipolo,1)
            plot(pos_dipolo(k,1),pos_dipolo(k,2),'m*');
             plot([pos_dipolo(k,1) pos_dipolo(k,1)+mom_dipolo(k,1)],...
                  [pos_dipolo(k,2) pos_dipolo(k,2)+mom_dipolo(k,2)],'md-');
       end
    end
    
    
    idx_fig=idx_fig+1;hold off;
    
    figure(idx_fig);
    v_samples=[1:num_muestras];
    subplot(4,1,1); plot(Pos_G(:,1)); ylabel('PosxG'); hold on; grid on; title('Position G (m)'); 
    if exist('Pos_G_rec','var'), plot(v_samples,Pos_G_rec(:,1),'r-.');  end
    subplot(4,1,2); plot(Pos_G(:,2)); ylabel('PosyG');hold on;  grid on; 
    if exist('Pos_G_rec','var'), plot(v_samples,Pos_G_rec(:,2),'r-.'); end
    subplot(4,1,3); plot(Pos_G(:,3)); ylabel('PoszG');hold on;  grid on; 
    if exist('Pos_G_rec','var'), plot(v_samples,Pos_G_rec(:,3),'r-.'); end
    subplot(4,1,4); plot(Stance,'g-'); ylabel('Stance & Step'); axis([get(gca,'XLim') -0.1 1.1]);
    hold on; plot(StepDectSample,zeros(1,length(StepDectSample)),'ro','MarkerSize',6,'MarkerFaceColor',[0 0 1]);
    xlabel('samples');
    idx_fig=idx_fig+1;hold off;
    
    figure(idx_fig);
    subplot(4,1,1); plot(Vel_G(:,1)); hold on;  ylabel('VelxG'); grid on;title('Velocity G (m/s)');
    if exist(',Vel_G_rec','var'), plot(v_samples,Vel_G_rec(:,1),'r-.'); end
    subplot(4,1,2); plot(Vel_G(:,2)); hold on;  ylabel('VelyG');grid on;
    if exist(',Vel_G_rec','var'),  plot(v_samples,Vel_G_rec(:,2),'r-.'); end
    subplot(4,1,3); plot(Vel_G(:,3)); hold on; ylabel('VelzG');grid on;
    if exist(',Vel_G_rec','var'), plot(v_samples,Vel_G_rec(:,3),'r-.'); end
    subplot(4,1,4); plot(Stance,'g-'); ylabel('Stance & Step'); axis([get(gca,'XLim') -0.1 1.1]);
    hold on; plot(StepDectSample,zeros(1,length(StepDectSample)),'ro','MarkerSize',6,'MarkerFaceColor',[0 0 1]);
    xlabel('samples');
    idx_fig=idx_fig+1;hold off;
    
    figure(idx_fig);
    subplot(4,1,1); plot(Acc_G(:,1)); hold on; ylabel('AccxG'); grid on;title('Acceleration G (m/s^2)');
    if exist(',Acc_G_sin_g_rec','var'), plot(v_samples,Acc_G_sin_g_rec(:,1),'r-.'); end
    subplot(4,1,2); plot(Acc_G(:,2)); hold on; ylabel('AccyG');grid on;
    if exist(',Acc_G_sin_g_rec','var'), plot(v_samples,Acc_G_sin_g_rec(:,2),'r-.'); end
    subplot(4,1,3); plot(Acc_G(:,3)); hold on; ylabel('AcczG');grid on;
    if exist(',Acc_G_sin_g_rec','var'), plot(v_samples,Acc_G_sin_g_rec(:,3),'r-.'); end
    subplot(4,1,4); plot(Stance,'g-'); ylabel('Stance & Step'); axis([get(gca,'XLim') -0.1 1.1]);
    hold on; plot(StepDectSample,zeros(1,length(StepDectSample)),'ro','MarkerSize',6,'MarkerFaceColor',[0 0 1]);
    xlabel('samples');
    idx_fig=idx_fig+1;hold off;
    
    figure(idx_fig);
    subplot(4,1,1); plot(Att_G(:,1)); ylabel('Roll'); grid on;title('Attitude G (degrees)');
    subplot(4,1,2); plot(Att_G(:,2)); ylabel('Pitch');grid on;
    subplot(4,1,3); plot(Att_G(:,3)); ylabel('Yaw');grid on;
    subplot(4,1,4); plot(Stance,'g-'); ylabel('Stance & Step'); axis([get(gca,'XLim') -0.1 1.1]);
    hold on; plot(StepDectSample,zeros(1,length(StepDectSample)),'ro','MarkerSize',6,'MarkerFaceColor',[0 0 1]);
    idx_fig=idx_fig+1;hold off;

       
    if hay(1)
        figure(idx_fig);
        subplot(3,1,1); plot(Acc(:,1)); ylabel('a_x'); grid on;title('IMU signal Acceleration S (m/s^2)');
        subplot(3,1,2); plot(Acc(:,2)); ylabel('a_y');grid on;
        subplot(3,1,3); plot(Acc(:,3)); ylabel('a_z');grid on;
        xlabel('samples');
        idx_fig=idx_fig+1;hold off;
    end
    
     figure(idx_fig);
        subplot(3,1,1); plot(Acc_recortado(:,1)); ylabel('a_x'); grid on;title('IMU signal Acceleration CAPTURED (m/s^2)');
        subplot(3,1,2); plot(Acc_recortado(:,2)); ylabel('a_y');grid on;
        subplot(3,1,3); plot(Acc_recortado(:,3)); ylabel('a_z');grid on;
        xlabel('samples');
        idx_fig=idx_fig+1;hold off;

    if hay(2)
        figure(idx_fig);
        ss=[1:num_muestras];
        subplot(3,1,1); plot(Gyr(:,1)*180/pi); hold on; %plot(ss,1+Gyr2(:,1),'r-'); plot(ss,2+Gyr3(:,1),'g-'); 
        ylabel('w_x'); grid on;title('IMU signal Angular rate S (º/s)'); %legend('Mio','Zampella','Similarity T.');
        subplot(3,1,2); plot(Gyr(:,2)*180/pi); hold on; %plot(ss,1+Gyr2(:,2),'r-');plot(ss,2+Gyr3(:,2),'g-');
        ylabel('w_y');grid on;
        subplot(3,1,3); plot(Gyr(:,3)*180/pi); hold on; %plot(ss,1+Gyr2(:,3),'r-');plot(ss,2+Gyr3(:,3),'g-');
        ylabel('w_z'); grid on;
        xlabel('samples');
        idx_fig=idx_fig+1;hold off;
    end
    
    figure(idx_fig);
        subplot(3,1,1); plot(Gyr_recortado(:,1)*180/pi); hold on; %plot(ss,1+Gyr2(:,1),'r-'); plot(ss,2+Gyr3(:,1),'g-'); 
        ylabel('w_x'); grid on;title('IMU signal Angular rate CAPTURED (º/s)'); %legend('Mio','Zampella','Similarity T.');
        subplot(3,1,2); plot(Gyr_recortado(:,2)*180/pi); hold on; %plot(ss,1+Gyr2(:,2),'r-');plot(ss,2+Gyr3(:,2),'g-');
        ylabel('w_y');grid on;
        subplot(3,1,3); plot(Gyr_recortado(:,3)*180/pi); hold on; %plot(ss,1+Gyr2(:,3),'r-');plot(ss,2+Gyr3(:,3),'g-');
        ylabel('w_z'); grid on;
        xlabel('samples');
        idx_fig=idx_fig+1;hold off;

    if hay(3)
        figure(idx_fig);
        subplot(3,1,1); plot(Mag(:,1)); ylabel('m_x'); grid on; title('IMU signal Magnetic field S (a.u.)');
        subplot(3,1,2); plot(Mag(:,2)); ylabel('m_y');grid on;
        subplot(3,1,3); plot(Mag(:,3)); ylabel('m_z');grid on;
        xlabel('samples');
        idx_fig=idx_fig+1;hold off;
    end
   

   
end % end- if ver
